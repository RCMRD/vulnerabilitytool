Ext.define("Ext.ProgressBar",{extend:"Ext.Component",alias:"widget.progressbar",requires:["Ext.Template","Ext.CompositeElement","Ext.TaskManager","Ext.layout.component.ProgressBar"],uses:["Ext.fx.Anim"],baseCls:Ext.baseCSSPrefix+"progress",animate:!1,text:"",waitTimer:null,childEls:["bar"],renderTpl:['<tpl if="internalText">','<div class="{baseCls}-text {baseCls}-text-back">{text}<\/div>',"<\/tpl>",'<div id="{id}-bar" class="{baseCls}-bar {baseCls}-bar-{ui}" style="width:{percentage}%">','<tpl if="internalText">','<div class="{baseCls}-text">',"<div>{text}<\/div>","<\/div>","<\/tpl>","<\/div>"],componentLayout:"progressbar",initComponent:function(){this.callParent();this.addEvents("update")},initRenderData:function(){var n=this;return Ext.apply(n.callParent(),{internalText:!n.hasOwnProperty("textEl"),text:n.text||"&#160;",percentage:n.value?n.value*100:0})},onRender:function(){var n=this;n.callParent(arguments);n.textEl?(n.textEl=Ext.get(n.textEl),n.updateText(n.text)):n.textEl=n.el.select("."+n.baseCls+"-text")},updateProgress:function(n,t,i){var r=this,u=r.value;return r.value=n||0,t&&r.updateText(t),r.rendered&&!r.isDestroyed&&(i===!0||i!==!1&&r.animate?(r.bar.stopAnimation(),r.bar.animate(Ext.apply({from:{width:u*100+"%"},to:{width:r.value*100+"%"}},r.animate))):r.bar.setStyle("width",r.value*100+"%")),r.fireEvent("update",r,r.value,t),r},updateText:function(n){var t=this;return t.text=n,t.rendered&&t.textEl.update(t.text),t},applyText:function(n){this.updateText(n)},getText:function(){return this.text},wait:function(n){var t=this,i;return t.waitTimer||(i=t,n=n||{},t.updateText(n.text),t.waitTimer=Ext.TaskManager.start({run:function(i){var r=n.increment||10;i-=1;t.updateProgress(((i+r)%r+1)*(100/r)*.01,null,n.animate)},interval:n.interval||1e3,duration:n.duration,onStop:function(){n.fn&&n.fn.apply(n.scope||t);t.reset()},scope:i})),t},isWaiting:function(){return this.waitTimer!==null},reset:function(n){var t=this;return t.updateProgress(0),t.clearTimer(),n===!0&&t.hide(),t},clearTimer:function(){var n=this;n.waitTimer&&(n.waitTimer.onStop=null,Ext.TaskManager.stop(n.waitTimer),n.waitTimer=null)},onDestroy:function(){var n=this,t=n.bar;n.clearTimer();n.rendered&&(n.textEl.isComposite&&n.textEl.clear(),Ext.destroyMembers(n,"textEl","progressBar"),t&&n.animate&&t.stopAnimation());n.callParent()}})