Ext.define("Ext.layout.container.Border",{extend:"Ext.layout.container.Container",alias:"layout.border",alternateClassName:"Ext.layout.BorderLayout",requires:["Ext.resizer.BorderSplitter","Ext.fx.Anim","Ext.layout.container.border.Region"],targetCls:Ext.baseCSSPrefix+"border-layout-ct",itemCls:[Ext.baseCSSPrefix+"border-item",Ext.baseCSSPrefix+"box-item"],type:"border",isBorderLayout:!0,padding:undefined,percentageRe:/(\d+)%/,horzMarginProp:"left",padOnContainerProp:"left",padNotOnContainerProp:"right",axisProps:{horz:{borderBegin:"west",borderEnd:"east",horizontal:!0,posProp:"x",sizeProp:"width",sizePropCap:"Width"},vert:{borderBegin:"north",borderEnd:"south",horizontal:!1,posProp:"y",sizeProp:"height",sizePropCap:"Height"}},centerRegion:null,manageMargins:!0,panelCollapseAnimate:!0,panelCollapseMode:"placeholder",regionWeights:{north:20,south:10,center:0,west:-10,east:-20},beginAxis:function(n,t,i){for(var l=this,o=l.axisProps[i],s=!o.horizontal,d=o.sizeProp,a=0,p=n.childItems,g=p.length,e,r,f,u,v,w,y,b,c,k,h=0;h<g;++h)if(r=p[h],u=r.target,r.layoutPos={},u.region){if(r.region=v=u.region,r.isCenter=u.isCenter,r.isHorz=u.isHorz,r.isVert=u.isVert,r.weight=u.weight||l.regionWeights[v]||0,t[u.id]=r,u.isCenter){e=r;f=u.flex;n.centerRegion=e;continue}if(s!==r.isVert)continue;r.reverseWeighting=v==o.borderEnd;y=u[d];b=typeof y;u.collapsed||(b=="string"&&(w=l.percentageRe.exec(y))?r.percentage=parseInt(w[1],10):u.flex&&(a+=r.flex=u.flex))}return e&&(c=e.target,(k=c.placeholderFor)?f||s!==k.collapsedVertical()||(f=0,e.collapseAxis=i):c.collapsed&&s===c.collapsedVertical()&&(f=0,e.collapseAxis=i)),f==null&&(f=1),a+=f,Ext.apply({before:s?"top":"left",totalFlex:a},o)},beginLayout:function(n){var i=this,f=i.getLayoutItems(),e=i.padding,a=typeof e,v=!1,r,o,c,u,l,t,s,y,h;for(e?(a=="string"||a=="number")&&(e=Ext.util.Format.parseBox(e)):(e=n.getEl("getTargetEl").getPaddingInfo(),v=!0),n.outerPad=e,n.padOnContainer=v,u=0,c=f.length;u<c;++u)o=f[u],t=i.getSplitterTarget(o),t&&(s=undefined,y=!!o.hidden,t.split?y!==t.hidden&&(s=!t.hidden):t.isCollapsingOrExpanding&&(s=!!t.collapsed),s?o.show():s===!1&&o.hide());for(i.callParent(arguments),f=n.childItems,c=f.length,l={},n.borderAxisHorz=i.beginAxis(n,l,"horz"),n.borderAxisVert=i.beginAxis(n,l,"vert"),u=0;u<c;++u)r=f[u],t=i.getSplitterTarget(r.target),t&&(h=l[t.id],h||(h=n.getEl(t.el,i),h.region=t.region),r.collapseTarget=t=h,r.weight=t.weight,r.reverseWeighting=t.reverseWeighting,t.splitter=r,r.isHorz=t.isHorz,r.isVert=t.isVert);i.sortWeightedItems(f,"reverseWeighting");i.setupSplitterNeighbors(f)},calculate:function(n){var u=this,v=u.getContainerSize(n),h=n.childItems,a=h.length,f=n.borderAxisHorz,e=n.borderAxisVert,o=n.outerPad,y=n.padOnContainer,r,t,s,i,c,l;for(f.begin=o[u.padOnContainerProp],e.begin=o.top,c=f.end=f.flexSpace=v.width+(y?o[u.padOnContainerProp]:-o[u.padNotOnContainerProp]),l=e.end=e.flexSpace=v.height+(y?o.top:-o.bottom),r=0;r<a;++r)t=h[r],s=t.getMarginInfo(),(t.isHorz||t.isCenter)&&(f.addUnflexed(s.width),c-=s.width),(t.isVert||t.isCenter)&&(e.addUnflexed(s.height),l-=s.height),t.flex||t.percentage||(t.isHorz||t.isCenter&&t.collapseAxis==="horz"?(i=t.getProp("width"),f.addUnflexed(i),t.collapseTarget&&(c-=i)):(t.isVert||t.isCenter&&t.collapseAxis==="vert")&&(i=t.getProp("height"),e.addUnflexed(i),t.collapseTarget&&(l-=i)));for(r=0;r<a;++r)t=h[r],s=t.getMarginInfo(),t.percentage&&(t.isHorz?(i=Math.ceil(c*t.percentage/100),i=t.setWidth(i),f.addUnflexed(i)):t.isVert&&(i=Math.ceil(l*t.percentage/100),i=t.setHeight(i),e.addUnflexed(i)));for(r=0;r<a;++r)t=h[r],t.isCenter||(u.calculateChildAxis(t,f),u.calculateChildAxis(t,e));u.finishAxis(n,e)+u.finishAxis(n,f)<2?u.done=!1:u.finishPositions(h)},calculateChildAxis:function(n,t){var s=n.collapseTarget,h="set"+t.sizePropCap,f=t.sizeProp,c=n.getMarginInfo()[f],r,e,o,u,i;s?r=s.region:(r=n.region,o=n.flex);e=r==t.borderBegin;e||r==t.borderEnd?(o?(i=Math.ceil(t.flexSpace*(o/t.totalFlex)),i=n[h](i)):i=n.percentage?n.peek(f):n.getProp(f),i+=c,e?(u=t.begin,t.begin+=i):t.end=u=t.end-i):(n[h](t.end-t.begin-c),u=t.begin);n.layoutPos[t.posProp]=u},finishAxis:function(n,t){var r=t.end-t.begin,i=n.centerRegion;return i&&(i["set"+t.sizePropCap](r-i.getMarginInfo()[t.sizeProp]),i.layoutPos[t.posProp]=t.begin),Ext.isNumber(r)?1:0},finishPositions:function(n){for(var r=n.length,t,u=this.horzMarginProp,i=0;i<r;++i)t=n[i],t.setProp("x",t.layoutPos.x+t.marginInfo[u]),t.setProp("y",t.layoutPos.y+t.marginInfo.top)},getLayoutItems:function(){for(var t=this.owner,u=t&&t.items&&t.items.items||[],e=u.length,f=[],i=0,n,r;i<e;i++)n=u[i],r=n.placeholderFor,!n.hidden&&(n.floated&&n.isCollapsingOrExpanding!==2||r&&r.isCollapsingOrExpanding===2)||f.push(n);return f},getPlaceholder:function(n){return n.getPlaceholder&&n.getPlaceholder()},getSplitterTarget:function(n){var t=n.collapseTarget;return t&&t.collapsed?t.placeholder||t:t},isItemBoxParent:function(){return!0},isItemShrinkWrap:function(){return!0},insertSplitter:function(n,t,i,r){var u=n.region,f=Ext.apply({xtype:"bordersplitter",collapseTarget:n,id:n.id+"-splitter",hidden:i,canResize:n.splitterResize!==!1,splitterFor:n},r),e=t+(u==="south"||u==="east"?0:1);n.collapseMode==="mini"&&(f.collapsedCls=n.collapsedCls);n.splitter=this.owner.add(e,f)},onAdd:function(n,t){var i=this,u=n.placeholderFor,f=n.region,r,e,o;i.callParent(arguments);f?(Ext.apply(n,i.regionFlags[f]),n.initBorderRegion&&n.initBorderRegion(),f==="center"?(i.centerRegion&&Ext.Error.raise("Cannot have multiple center regions in a BorderLayout."),i.centerRegion=n):(r=n.split,e=!!n.hidden,typeof r=="object"&&(o=r,r=!0),(n.isHorz||n.isVert)&&(r||n.collapseMode=="mini")&&i.insertSplitter(n,t,e||!r,o)),n.hasOwnProperty("collapseMode")||(n.collapseMode=i.panelCollapseMode),n.hasOwnProperty("animCollapse")||(n.animCollapse=n.collapseMode!=="placeholder"?!1:i.panelCollapseAnimate)):u&&(Ext.apply(n,i.regionFlags[u.region]),n.region=u.region,n.weight=u.weight)},onDestroy:function(){this.centerRegion=null;this.callParent()},onRemove:function(n){var t=this,r=n.region,i=n.splitter;r&&(n.isCenter&&(t.centerRegion=null),delete n.isCenter,delete n.isHorz,delete n.isVert,i&&(t.owner.doRemove(i,!0),delete n.splitter));t.callParent(arguments)},regionMeta:{center:{splitterDelta:0},north:{splitterDelta:1},south:{splitterDelta:-1},west:{splitterDelta:1},east:{splitterDelta:-1}},regionFlags:{center:{isCenter:!0,isHorz:!1,isVert:!1},north:{isCenter:!1,isHorz:!1,isVert:!0,collapseDirection:"top"},south:{isCenter:!1,isHorz:!1,isVert:!0,collapseDirection:"bottom"},west:{isCenter:!1,isHorz:!0,isVert:!1,collapseDirection:"left"},east:{isCenter:!1,isHorz:!0,isVert:!1,collapseDirection:"right"}},setupSplitterNeighbors:function(n){for(var h={},a=n.length,l=this.touchedRegions,t,c,e,r,i,o,s,u,f=0;f<a;++f)if(i=n[f].target,o=i.region,i.isCenter)c=i;else if(o){for(u=l[o],t=0,e=u.length;t<e;++t)r=h[u[t]],r&&r.neighbors.push(i);s=i.placeholderFor?i.placeholderFor.splitter:i.splitter;s&&(s.neighbors=[]);h[o]=s}if(c)for(u=l.center,t=0,e=u.length;t<e;++t)r=h[u[t]],r&&r.neighbors.push(c)},touchedRegions:{center:["north","south","east","west"],north:["north","east","west"],south:["south","east","west"],east:["east","north","south"],west:["west","north","south"]},sizePolicies:{vert:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},horz:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},flexAll:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}},getItemSizePolicy:function(n){var e=this,t=this.sizePolicies,r,i,u,f;return n.isCenter?(f=n.placeholderFor,f)?f.collapsedVertical()?t.vert:t.horz:n.collapsed?n.collapsedVertical()?t.vert:t.horz:t.flexAll:(r=n.collapseTarget,r)?r.isVert?t.vert:t.horz:n.region?(n.isVert?(i=n.height,u=t.vert):(i=n.width,u=t.horz),n.flex||typeof i=="string"&&e.percentageRe.test(i))?t.flexAll:u:e.autoSizePolicy}},function(){var n={addUnflexed:function(n){this.flexSpace=Math.max(this.flexSpace-n,0)}},t=this.prototype.axisProps;Ext.apply(t.horz,n);Ext.apply(t.vert,n)})