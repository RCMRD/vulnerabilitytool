Ext.define("Ext.layout.container.Table",{alias:["layout.table"],extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.TableLayout",monitorResize:!1,type:"table",createsInnerCt:!0,targetCls:Ext.baseCSSPrefix+"table-layout-ct",tableCls:Ext.baseCSSPrefix+"table-layout",cellCls:Ext.baseCSSPrefix+"table-layout-cell",tableAttrs:null,getItemSizePolicy:function(){return this.autoSizePolicy},initHierarchyState:function(n){n.inShrinkWrapTable=!0},getLayoutItems:function(){for(var u=this,i=[],r=u.callParent(),t,f=r.length,n=0;n<f;n++)t=r[n],t.hidden||i.push(t);return i},getHiddenItems:function(){for(var i=[],r=this.owner.items.items,u=r.length,t=0,n;t<u;++t)n=r[t],n.rendered&&n.hidden&&i.push(n);return i},renderChildren:function(){for(var n=this,c=n.getLayoutItems(),s=n.owner.getTargetEl().child("table",!0).tBodies[0],y=s.rows,i=0,l=c.length,v=n.getHiddenItems(),a,r,f,t,u,e,o,h=n.calculateCells(c);i<l;i++)if(a=h[i],r=a.rowIdx,f=a.cellIdx,t=c[i],u=y[r],u||(u=s.insertRow(r),n.trAttrs&&u.set(n.trAttrs)),o=e=Ext.get(u.cells[f]||u.insertCell(f)),n.needsDivWrap()&&(o=e.first()||e.createChild({tag:"div"}),o.setWidth(null)),t.rendered?n.isValidParent(t,o,r,f,s)||n.moveItem(t,o,0):n.renderItem(t,o,0),n.tdAttrs&&e.set(n.tdAttrs),t.tdAttrs&&e.set(t.tdAttrs),e.set({colSpan:t.colspan||1,rowSpan:t.rowspan||1,id:t.cellId||"",cls:n.cellCls+" "+(t.cellCls||"")}),!h[i+1]||h[i+1].rowIdx!==r)for(f++;u.cells[f];)u.deleteCell(f);for(r++;s.rows[r];)s.deleteRow(r);for(i=0,l=v.length;i<l;++i)n.ensureInDocument(v[i].getEl())},ensureInDocument:function(n){for(var t=n.dom.parentNode;t;){if(t.tagName.toUpperCase()=="BODY")return;t=t.parentNode}Ext.getDetachedBody().appendChild(n)},calculate:function(n){if(n.hasDomProp("containerChildrenSizeDone")){var t=n.targetContext,i=n.widthModel.shrinkWrap,r=n.heightModel.shrinkWrap,u=r||i,f=u&&t.el.child("table",!0),e=u&&t.getPaddingInfo();i&&n.setContentWidth(f.offsetWidth+e.width,!0);r&&n.setContentHeight(f.offsetHeight+e.height,!0)}else this.done=!1},finalizeLayout:function(){if(this.needsDivWrap())for(var i=this.getLayoutItems(),r=i.length,t,n=0;n<r;n++)t=i[n],Ext.fly(t.el.dom.parentNode).setWidth(t.getWidth());(Ext.isIE6||Ext.isIEQuirks)&&this.owner.getTargetEl().child("table").repaint()},calculateCells:function(n){for(var s=[],h=0,i=0,u=0,f=this.columns||Infinity,r=[],e=0,t,c=n.length,o;e<c;e++){for(o=n[e];i>=f||r[i]>0;)if(i>=f)for(i=0,u=0,h++,t=0;t<f;t++)r[t]>0&&r[t]--;else i++;for(s.push({rowIdx:h,cellIdx:u}),t=o.colspan||1;t;--t)r[i]=o.rowspan||1,++i;++u}return s},getRenderTree:function(){for(var n=this,f=n.getLayoutItems(),e=[],a=Ext.apply({tag:"table",role:"presentation",cls:n.tableCls,cellspacing:0,cellpadding:0,cn:{tag:"tbody",cn:e}},n.tableAttrs),c=n.tdAttrs,v=n.needsDivWrap(),y=f.length,t,o,u,s,l,i,h=n.calculateCells(f),r=0;r<y;r++)t=f[r],o=h[r],s=o.rowIdx,l=o.cellIdx,u=e[s],u||(u=e[s]={tag:"tr",cn:[]},n.trAttrs&&Ext.apply(u,n.trAttrs)),i=u.cn[l]={tag:"td"},c&&Ext.apply(i,c),Ext.apply(i,{colSpan:t.colspan||1,rowSpan:t.rowspan||1,id:t.cellId||"",cls:n.cellCls+" "+(t.cellCls||"")}),v&&(i=i.cn={tag:"div"}),n.configureItem(t),i.cn=t.getRenderTree();return a},isValidParent:function(n,t,i,r){var f,e,u;return arguments.length===3?(u=n.el.up("table"),u&&u.dom.parentNode===t.dom):(f=this.owner.getTargetEl().child("table",!0).tBodies[0],e=f.rows[i].cells[r],n.el.dom.parentNode===e)},needsDivWrap:function(){return Ext.isOpera10_5}})