Ext.define("Ext.tree.Panel",{extend:"Ext.panel.Table",alias:"widget.treepanel",alternateClassName:["Ext.tree.TreePanel","Ext.TreePanel"],requires:["Ext.tree.View","Ext.selection.TreeModel","Ext.tree.Column","Ext.data.TreeStore"],viewType:"treeview",selType:"treemodel",treeCls:Ext.baseCSSPrefix+"tree-panel",deferRowRender:!1,rowLines:!1,lines:!0,useArrows:!1,singleExpand:!1,ddConfig:{enableDrag:!0,enableDrop:!0},rootVisible:!0,displayField:"text",root:null,normalCfgCopy:["displayField","root","singleExpand","useArrows","lines","rootVisible","scroll"],lockedCfgCopy:["displayField","root","singleExpand","useArrows","lines","rootVisible"],isTree:!0,arrowCls:Ext.baseCSSPrefix+"tree-arrows",linesCls:Ext.baseCSSPrefix+"tree-lines",noLinesCls:Ext.baseCSSPrefix+"tree-no-lines",autoWidthCls:Ext.baseCSSPrefix+"autowidth-table",constructor:function(n){n=n||{};n.animate===undefined&&(n.animate=Ext.isBoolean(this.animate)?this.animate:Ext.enableFx);this.enableAnimations=n.animate;delete n.animate;this.callParent([n])},initComponent:function(){var n=this,i=[n.treeCls],t=n.store,r;n.useArrows&&(i.push(n.arrowCls),n.lines=!1);n.lines?i.push(n.linesCls):n.useArrows||i.push(n.noLinesCls);Ext.isString(t)?t=n.store=Ext.StoreMgr.lookup(t):t&&(!Ext.isObject(t)||t.isStore)?n.root&&(t=n.store=Ext.data.StoreManager.lookup(t),t.setRootNode(n.root),n.folderSort!==undefined&&(t.folderSort=n.folderSort,t.sort())):t=n.store=new Ext.data.TreeStore(Ext.apply({root:n.root,fields:n.fields,model:n.model,folderSort:n.folderSort},t));n.viewConfig=Ext.apply({rootVisible:n.rootVisible,animate:n.enableAnimations,singleExpand:n.singleExpand,node:t.getRootNode(),hideHeaders:n.hideHeaders},n.viewConfig);n.columns||(n.initialConfig.hideHeaders===undefined&&(n.hideHeaders=!0),n.addCls(n.autoWidthCls),n.columns=[{xtype:"treecolumn",text:"Name",width:Ext.isIE6?"100%":1e4,dataIndex:n.displayField}]);n.cls&&i.push(n.cls);n.cls=i.join(" ");n.callParent();n.selModel.treeStore=n.store;r=n.getView();n.relayEvents(r,["checkchange","afteritemexpand","afteritemcollapse"]);r.isLockingView||r.rootVisible||n.getRootNode()||n.setRootNode({expanded:!0})},bindStore:function(n,t){var i=this;i.store=n;i.storeListeners=i.mon(n,{destroyable:!0,load:i.onStoreLoad,rootchange:i.onRootChange,clear:i.onClear,scope:i});i.storeRelayers=i.relayEvents(n,["beforeload","load"]);i.storeRelayers1=i.mon(n,{destroyable:!0,append:i.createRelayer("itemappend"),remove:i.createRelayer("itemremove"),move:i.createRelayer("itemmove",[0,4]),insert:i.createRelayer("iteminsert"),beforeappend:i.createRelayer("beforeitemappend"),beforeremove:i.createRelayer("beforeitemremove"),beforemove:i.createRelayer("beforeitemmove"),beforeinsert:i.createRelayer("beforeiteminsert"),expand:i.createRelayer("itemexpand",[0,1]),collapse:i.createRelayer("itemcollapse",[0,1]),beforeexpand:i.createRelayer("beforeitemexpand",[0,1]),beforecollapse:i.createRelayer("beforeitemcollapse",[0,1])});n.ownerTree=i;t||i.view.setRootNode(i.getRootNode())},unbindStore:function(){var n=this,t=n.store;t&&(Ext.destroy(n.storeListeners,n.storeRelayers,n.storeRelayers1),delete t.ownerTree)},onClear:function(){this.view.onClear()},setRootNode:function(){return this.store.setRootNode.apply(this.store,arguments)},getRootNode:function(){return this.store.getRootNode()},onRootChange:function(n){this.view.setRootNode(n)},getChecked:function(){return this.getView().getChecked()},isItemChecked:function(n){return n.get("checked")},expandNode:function(n,t,i,r){return this.getView().expand(n,t,i,r||this)},collapseNode:function(n,t,i,r){return this.getView().collapse(n,t,i,r||this)},expandAll:function(n,t){var i=this,r=i.getRootNode(),u=i.enableAnimations;r&&(u||Ext.suspendLayouts(),r.expand(!0,n,t||i),u||Ext.resumeLayouts(!0))},collapseAll:function(n,t){var i=this,r=i.getRootNode(),u=i.enableAnimations,f=i.getView();r&&(u||Ext.suspendLayouts(),t=t||i,f.rootVisible?r.collapse(!0,n,t):r.collapseChildren(!0,n,t),u||Ext.resumeLayouts(!0))},expandPath:function(n,t,i,r,u){var e=this,f=e.getRootNode(),h=1,c=e.getView(),o,s;if(t=t||e.getRootNode().idProperty,i=i||"/",Ext.isEmpty(n)){Ext.callback(r,u||e,[!1,null]);return}if(o=n.split(i),f.get(t)!=o[1]){Ext.callback(r,u||e,[!1,f]);return}s=function(){if(++h===o.length){Ext.callback(r,u||e,[!0,f]);return}var n=f.findChild(t,o[h]);if(!n){Ext.callback(r,u||e,[!1,f]);return}f=n;f.expand(!1,s)};f.expand(!1,s)},selectPath:function(n,t,i,r,u){var f=this,e,o,s;t=t||f.getRootNode().idProperty;i=i||"/";o=n.split(i);s=o.pop();o.length>1?f.expandPath(o.join(i),t,i,function(n,i){var e=i;if(n&&i&&(i=i.findChild(t,s),i)){f.getSelectionModel().select(i);Ext.callback(r,u||f,[!0,i]);return}Ext.callback(r,u||f,[!1,e])},f):(e=f.getRootNode(),e.getId()===s?(f.getSelectionModel().select(e),Ext.callback(r,u||f,[!0,e])):Ext.callback(r,u||f,[!1,null]))}})