Ext.define("Ext.panel.Table",{extend:"Ext.panel.Panel",alias:"widget.tablepanel",uses:["Ext.selection.RowModel","Ext.selection.CellModel","Ext.selection.CheckboxModel","Ext.grid.plugin.BufferedRenderer","Ext.grid.header.Container","Ext.grid.locking.Lockable"],extraBaseCls:Ext.baseCSSPrefix+"grid",extraBodyCls:Ext.baseCSSPrefix+"grid-body",layout:"fit",hasView:!1,viewType:null,selType:"rowmodel",scroll:!0,deferRowRender:!0,sortableColumns:!0,enableLocking:!1,scrollerOwner:!0,enableColumnMove:!0,sealedColumns:!1,enableColumnResize:!0,rowLines:!0,colLinesCls:Ext.baseCSSPrefix+"grid-with-col-lines",rowLinesCls:Ext.baseCSSPrefix+"grid-with-row-lines",noRowLinesCls:Ext.baseCSSPrefix+"grid-no-row-lines",hiddenHeaderCtCls:Ext.baseCSSPrefix+"grid-header-ct-hidden",hiddenHeaderCls:Ext.baseCSSPrefix+"grid-header-hidden",resizeMarkerCls:Ext.baseCSSPrefix+"grid-resize-marker",emptyCls:Ext.baseCSSPrefix+"grid-empty",initComponent:function(){this.viewType||Ext.Error.raise("You must specify a viewType config.");this.headers&&Ext.Error.raise("The headers config is not supported. Please specify columns instead.");var n=this,t=n.columns||n.colModel,i,r,e,u=n.store=Ext.data.StoreManager.lookup(n.store||"ext-empty-store"),f;if(n.columnLines&&n.addCls(n.colLinesCls),n.addCls(n.rowLines?n.rowLinesCls:n.noRowLinesCls),t||Ext.Error.raise("A column configuration must be specified"),t instanceof Ext.grid.header.Container?(t.isRootHeader=!0,n.headerCt=t):n.enableLocking||n.hasLockedColumns(t)?(n.self.mixin("lockable",Ext.grid.locking.Lockable),n.injectLockable()):(Ext.isArray(t)&&(t={items:t}),Ext.apply(t,{grid:n,forceFit:n.forceFit,sortable:n.sortableColumns,enableColumnMove:n.enableColumnMove,enableColumnResize:n.enableColumnResize,sealed:n.sealedColumns,isRootHeader:!0}),Ext.isDefined(n.enableColumnHide)&&(t.enableColumnHide=n.enableColumnHide),n.headerCt||(n.headerCt=new Ext.grid.header.Container(t))),n.columns=n.headerCt.getGridColumns(),n.scrollTask=new Ext.util.DelayedTask(n.syncHorizontalScroll,n),n.addEvents("reconfigure","viewready"),n.bodyCls=n.bodyCls||"",n.bodyCls+=" "+n.extraBodyCls,n.cls=n.cls||"",n.cls+=" "+n.extraBaseCls,delete n.autoScroll,!n.hasView){if(f=n.headerCt.getGridColumns(),u.buffered&&!u.remoteSort)for(r=0,e=f.length;r<e;r++)f[r].sortable=!1;if(n.hideHeaders&&(n.headerCt.height=0,n.headerCt.hiddenHeaders=!0,n.headerCt.addCls(n.hiddenHeaderCtCls),n.addCls(n.hiddenHeaderCls),Ext.isIEQuirks&&(n.headerCt.style={display:"none"})),n.relayHeaderCtEvents(n.headerCt),n.features=n.features||[],Ext.isArray(n.features)||(n.features=[n.features]),n.dockedItems=[].concat(n.dockedItems||[]),n.dockedItems.unshift(n.headerCt),n.viewConfig=n.viewConfig||{},i=n.getView(),n.items=[i],n.hasView=!0,!n.hideHeaders)i.on({scroll:{fn:n.onHorizontalScroll,element:"el",scope:n}});n.bindStore(u,!0);n.mon(i,{viewready:n.onViewReady,refresh:n.onRestoreHorzScroll,scope:n})}if(n.relayEvents(n.view,["beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","beforecellclick","cellclick","beforecelldblclick","celldblclick","beforecellcontextmenu","cellcontextmenu","beforecellmousedown","cellmousedown","beforecellmouseup","cellmouseup","beforecellkeydown","cellkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","containermouseup","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","selectionchange","beforeselect","select","beforedeselect","deselect"]),n.callParent(arguments),n.addStateEvents(["columnresize","columnmove","columnhide","columnshow","sortchange","filterchange"]),!n.lockable&&n.headerCt)n.headerCt.on("afterlayout",n.onRestoreHorzScroll,n)},hasLockedColumns:function(n){var t,r,i;for(Ext.isObject(n)&&(n=n.items),t=0,r=n.length;t<r;t++)if(i=n[t],!i.processed&&i.locked)return!0},relayHeaderCtEvents:function(n){this.relayEvents(n,["columnresize","columnmove","columnhide","columnshow","columnschanged","sortchange","headerclick","headercontextmenu","headertriggerclick"])},getState:function(){var n=this,t=n.callParent(),i=n.store.getState();return t=n.addPropertyToState(t,"columns",n.headerCt.getColumnsState()),i&&(t.storeState=i),t},applyState:function(n){var r=this,t=n.sort,u=n.storeState,i=r.store,f=n.columns;delete n.columns;r.callParent(arguments);f&&r.headerCt.applyColumnsState(f);t?i.remoteSort?i.sort({property:t.property,direction:t.direction,root:t.root},null,!1):i.sort(t.property,t.direction):u&&i.applyState(u)},getStore:function(){return this.store},getView:function(){var n=this,t;return n.view||(t=n.getSelectionModel(),Ext.widget(Ext.apply({grid:n,deferInitialRefresh:n.deferRowRender!==!1,trackOver:n.trackMouseOver!==!1,scroll:n.scroll,xtype:n.viewType,store:n.store,headerCt:n.headerCt,columnLines:n.columnLines,rowLines:n.rowLines,selModel:t,features:n.features,panel:n,emptyText:n.emptyText||""},n.viewConfig)),n.view.emptyText&&(n.view.emptyText='<div class="'+n.emptyCls+'">'+n.view.emptyText+"<\/div>"),n.view.getComponentLayout().headerCt=n.headerCt,n.mon(n.view,{uievent:n.processEvent,scope:n}),t.view=n.view,n.headerCt.view=n.view),n.view},setAutoScroll:Ext.emptyFn,processEvent:function(n,t,i,r,u){var e=this,f;if(u!==-1)return f=e.columnManager.getColumns()[u],f.processEvent.apply(f,arguments)},determineScrollbars:function(){Ext.log.warn("Obsolete")},invalidateScroller:function(){Ext.log.warn("Obsolete")},scrollByDeltaY:function(n,t){this.getView().scrollBy(0,n,t)},scrollByDeltaX:function(n,t){this.getView().scrollBy(n,0,t)},afterCollapse:function(){var n=this;n.saveScrollPos();n.saveScrollPos();n.callParent(arguments)},afterExpand:function(){var n=this;n.callParent(arguments);n.restoreScrollPos();n.restoreScrollPos()},saveScrollPos:Ext.emptyFn,restoreScrollPos:Ext.emptyFn,onHeaderResize:function(){this.delayScroll()},onHeaderMove:function(n,t,i,r,u){var f=this;f.optimizedColumnMove===!1?f.view.refresh():f.view.moveColumn(r,u,i);f.delayScroll()},onHeaderHide:function(){this.view.refresh();this.delayScroll()},onHeaderShow:function(){this.view.refresh();this.delayScroll()},delayScroll:function(){var n=this.getScrollTarget().el;n&&this.scrollTask.delay(10,null,null,[n.dom.scrollLeft])},onViewReady:function(){this.fireEvent("viewready",this)},onRestoreHorzScroll:function(){var n=this.scrollLeftPos;n&&this.syncHorizontalScroll(n,!0)},getScrollerOwner:function(){var n=this;return this.scrollerOwner||(n=this.up("[scrollerOwner]")),n},getLhsMarker:function(){var n=this;return n.lhsMarker||(n.lhsMarker=Ext.DomHelper.append(n.el,{cls:n.resizeMarkerCls},!0))},getRhsMarker:function(){var n=this;return n.rhsMarker||(n.rhsMarker=Ext.DomHelper.append(n.el,{cls:n.resizeMarkerCls},!0))},getSelectionModel:function(){var t=this,n=t.selModel,r,i,u;return n||(n={},r=!0),n.events||(u=n.selType||t.selType,r=!n.mode,n=t.selModel=Ext.create("selection."+u,n)),t.simpleSelect?i="SIMPLE":t.multiSelect&&(i="MULTI"),Ext.applyIf(n,{allowDeselect:t.allowDeselect}),i&&r&&n.setSelectionMode(i),n.hasRelaySetup||(t.relayEvents(n,["selectionchange","beforeselect","beforedeselect","select","deselect"]),n.hasRelaySetup=!0),t.disableSelection&&(n.locked=!0),n},getScrollTarget:function(){var t=this.getScrollerOwner(),n=t.query("tableview");return n[1]||n[0]},onHorizontalScroll:function(n,t){this.syncHorizontalScroll(t.scrollLeft)},syncHorizontalScroll:function(n,t){var i=this,r;t=t===!0;i.rendered&&(t||n!==i.scrollLeftPos)&&(t&&(r=i.getScrollTarget(),r.el.dom.scrollLeft=n),i.headerCt.el.dom.scrollLeft=n,i.scrollLeftPos=n)},onStoreLoad:Ext.emptyFn,getEditorParent:function(){return this.body},bindStore:function(n,t){var i=this,u=i.getView(),f=n&&n.buffered,r;i.store=n;r=i.findPlugin("bufferedrenderer");r?(i.verticalScroller=r,r.store&&r.bindStore(n)):f&&(i.verticalScroller=r=i.addPlugin(Ext.apply({ptype:"bufferedrenderer"},i.initialConfig.verticalScroller)));u.store!==n&&(t?u.bindStore(n,!1,"dataSource"):u.bindStore(n,!1));i.mon(n,{load:i.onStoreLoad,scope:i});i.storeRelayers=i.relayEvents(n,["filterchange"]);r&&(i.invalidateScrollerOnRefresh=!1);i.invalidateScrollerOnRefresh!==undefined&&(u.preserveScrollOnRefresh=!i.invalidateScrollerOnRefresh)},unbindStore:function(){var n=this,t=n.store;t&&(n.store=null,n.mun(t,{load:n.onStoreLoad,scope:n}),Ext.destroy(n.storeRelayers))},reconfigure:function(n,t){var i=this,u=i.getView(),e,f=i.store,r=i.headerCt,o=r?r.items.getRange():i.columns;t&&(t=Ext.Array.slice(t));i.fireEvent("beforereconfigure",i,n,t,f,o);i.lockable?i.reconfigureLockable(n,t):(Ext.suspendLayouts(),t&&(delete i.scrollLeftPos,r.removeAll(),r.add(t)),n&&(n=Ext.StoreManager.lookup(n))!==f?(i.store&&i.unbindStore(),e=u.deferInitialRefresh,u.deferInitialRefresh=!1,i.bindStore(n),u.deferInitialRefresh=e):i.getView().refresh(),r.setSortState(),Ext.resumeLayouts(!0));i.fireEvent("reconfigure",i,n,t,f,o)},beforeDestroy:function(){var n=this.scrollTask;n&&(n.cancel(),this.scrollTask=null);this.callParent()},onDestroy:function(){this.lockable&&this.destroyLockable();this.callParent()}})