Ext.define("Ext.fx.Animator",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.fx.Manager"],isAnimator:!0,duration:250,delay:0,delayStart:0,dynamic:!1,easing:"ease",running:!1,paused:!1,damper:1,iterations:1,currentIteration:0,keyframeStep:0,animKeyFramesRE:/^(from|to|\d+%?)$/,constructor:function(n){var t=this;n=Ext.apply(t,n||{});t.config=n;t.id=Ext.id(null,"ext-animator-");t.addEvents("beforeanimate","keyframe","afteranimate");t.mixins.observable.constructor.call(t,n);t.timeline=[];t.createTimeline(t.keyframes);t.target&&(t.applyAnimator(t.target),Ext.fx.Manager.addAnim(t))},sorter:function(n,t){return n.pct-t.pct},createTimeline:function(n){var u=this,i=[],c=u.to||{},e=u.duration,o,s,r,h,t,f;for(t in n)n.hasOwnProperty(t)&&u.animKeyFramesRE.test(t)&&(f={attrs:Ext.apply(n[t],c)},t=="from"?t=0:t=="to"&&(t=100),f.pct=parseInt(t,10),i.push(f));for(Ext.Array.sort(i,u.sorter),h=i.length,r=0;r<h;r++)o=i[r-1]?e*(i[r-1].pct/100):0,s=e*(i[r].pct/100),u.timeline.push({duration:s-o,attrs:i[r].attrs})},applyAnimator:function(n){var i=this,f=[],o=i.timeline,e=o.length,t,s,h,u,r;if(i.fireEvent("beforeanimate",i)!==!1){for(r=0;r<e;r++)t=o[r],u=t.attrs,s=u.easing||i.easing,h=u.damper||i.damper,delete u.easing,delete u.damper,t=new Ext.fx.Anim({target:n,easing:s,damper:h,duration:t.duration,paused:!0,to:u}),f.push(t);for(i.animations=f,i.target=t.target,r=0;r<e-1;r++){t=f[r];t.nextAnim=f[r+1];t.on("afteranimate",function(){this.nextAnim.paused=!1});t.on("afteranimate",function(){this.fireEvent("keyframe",this,++this.keyframeStep)},i)}f[e-1].on("afteranimate",function(){this.lastFrame()},i)}},start:function(n){var t=this,i=t.delay,r=t.delayStart,u;if(i)if(r){if(u=n-r,u<i)return;n=new Date(r.getTime()+i)}else{t.delayStart=n;return}t.fireEvent("beforeanimate",t)!==!1&&(t.startTime=n,t.running=!0,t.animations[t.keyframeStep].paused=!1)},lastFrame:function(){var n=this,i=n.iterations,t=n.currentIteration;t++;t<i?(n.startTime=new Date,n.currentIteration=t,n.keyframeStep=0,n.applyAnimator(n.target),n.animations[n.keyframeStep].paused=!1):(n.currentIteration=0,n.end())},end:function(){var n=this;n.fireEvent("afteranimate",n,n.startTime,new Date-n.startTime)},isReady:function(){return this.paused===!1&&this.running===!1&&this.iterations>0},isRunning:function(){return!1}})