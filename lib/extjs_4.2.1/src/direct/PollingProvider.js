Ext.define("Ext.direct.PollingProvider",{extend:"Ext.direct.JsonProvider",alias:"direct.pollingprovider",requires:["Ext.Ajax","Ext.util.DelayedTask"],uses:["Ext.direct.ExceptionEvent","Ext.direct.Manager"],interval:3e3,constructor:function(){var n=this;n.callParent(arguments);n.addEvents("beforepoll","poll")},isConnected:function(){return!!this.pollTask},connect:function(){var n=this,t=n.url;t&&!n.pollTask?(n.pollTask=Ext.TaskManager.start({run:n.runPoll,interval:n.interval,scope:n}),n.fireEvent("connect",n)):t||Ext.Error.raise("Error initializing PollingProvider, no url configured.")},disconnect:function(){var n=this;n.pollTask&&(Ext.TaskManager.stop(n.pollTask),delete n.pollTask,n.fireEvent("disconnect",n))},runPoll:function(){var n=this,t=n.url;n.fireEvent("beforepoll",n)!==!1&&(Ext.isFunction(t)?t(n.baseParams):Ext.Ajax.request({url:t,callback:n.onData,scope:n,params:n.baseParams}),n.fireEvent("poll",n))},onData:function(n,t,i){var r=this,f,e,u;if(t)for(u=r.createEvents(i),f=0,e=u.length;f<e;++f)r.fireEvent("data",r,u[f]);else u=new Ext.direct.ExceptionEvent({data:null,code:Ext.direct.Manager.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:i}),r.fireEvent("data",r,u)}})