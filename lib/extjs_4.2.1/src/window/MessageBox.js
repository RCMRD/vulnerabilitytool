Ext.define("Ext.window.MessageBox",{extend:"Ext.window.Window",requires:["Ext.toolbar.Toolbar","Ext.form.field.Text","Ext.form.field.TextArea","Ext.form.field.Display","Ext.button.Button","Ext.layout.container.Anchor","Ext.layout.container.HBox","Ext.ProgressBar"],alias:"widget.messagebox",OK:1,YES:2,NO:4,CANCEL:8,OKCANCEL:9,YESNO:6,YESNOCANCEL:14,INFO:Ext.baseCSSPrefix+"message-box-info",WARNING:Ext.baseCSSPrefix+"message-box-warning",QUESTION:Ext.baseCSSPrefix+"message-box-question",ERROR:Ext.baseCSSPrefix+"message-box-error",hideMode:"offsets",closeAction:"hide",resizable:!1,title:"&#160;",defaultMinWidth:250,defaultMaxWidth:600,defaultMinHeight:110,defaultMaxHeight:500,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,constrain:!0,cls:[Ext.baseCSSPrefix+"message-box",Ext.baseCSSPrefix+"hide-offsets"],layout:{type:"vbox",align:"stretch"},shrinkWrapDock:!0,defaultTextHeight:75,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel"},buttonIds:["ok","yes","no","cancel"],titleText:{confirm:"Confirm",prompt:"Prompt",wait:"Loading...",alert:"Attention"},iconHeight:35,iconWidth:50,makeButton:function(n){var t=this.buttonIds[n];return new Ext.button.Button({handler:this.btnCallback,itemId:t,scope:this,text:this.buttonText[t],minWidth:75})},btnCallback:function(n){var t=this,r,i;(t.cfg.prompt||t.cfg.multiline)&&(i=t.cfg.multiline?t.textArea:t.textField,r=i.getValue(),i.reset());t.hide();t.userCallback(n.itemId,r,t.cfg)},hide:function(){var n=this,t=n.cfg.cls;n.dd.endDrag();n.progressBar.reset();t&&n.removeCls(t);n.callParent(arguments)},constructor:function(){var n=this;n.callParent(arguments);n.minWidth=n.defaultMinWidth=n.minWidth||n.defaultMinWidth;n.maxWidth=n.defaultMaxWidth=n.maxWidth||n.defaultMaxWidth;n.minHeight=n.defaultMinHeight=n.minHeight||n.defaultMinHeight;n.maxHeight=n.defaultMaxHeight=n.maxHeight||n.defaultMaxHeight},initComponent:function(){var n=this,t=n.id,i,r;for(n.title="&#160;",n.topContainer=new Ext.container.Container({layout:"hbox",padding:10,style:{overflow:"hidden"},items:[n.iconComponent=new Ext.Component({width:n.iconWidth,height:n.iconHeight}),n.promptContainer=new Ext.container.Container({flex:1,layout:"anchor",items:[n.msg=new Ext.form.field.Display({id:t+"-displayfield",cls:n.baseCls+"-text"}),n.textField=new Ext.form.field.Text({id:t+"-textfield",anchor:"100%",enableKeyEvents:!0,listeners:{keydown:n.onPromptKey,scope:n}}),n.textArea=new Ext.form.field.TextArea({id:t+"-textarea",anchor:"100%",height:75})]})]}),n.progressBar=new Ext.ProgressBar({id:t+"-progressbar",margins:"0 10 10 10"}),n.items=[n.topContainer,n.progressBar],n.msgButtons=[],i=0;i<4;i++)r=n.makeButton(i),n.msgButtons[r.itemId]=r,n.msgButtons.push(r);n.bottomTb=new Ext.toolbar.Toolbar({id:t+"-toolbar",ui:"footer",dock:"bottom",layout:{pack:"center"},items:[n.msgButtons[0],n.msgButtons[1],n.msgButtons[2],n.msgButtons[3]]});n.dockedItems=[n.bottomTb];n.on("close",n.onClose,n);n.callParent()},onClose:function(){var n=this.header.child("[type=close]");n.itemId="cancel";this.btnCallback(n);delete n.itemId},onPromptKey:function(n,t){var i=this;(t.keyCode===t.RETURN||t.keyCode===10)&&(i.msgButtons.ok.isVisible()?i.msgButtons.ok.handler.call(i,i.msgButtons.ok):i.msgButtons.yes.isVisible()&&i.msgButtons.yes.handler.call(i,i.msgButtons.yes))},reconfigure:function(n){var t=this,e=0,v=!0,y=t.buttonText,u=t.resizer,o,s,h,i,r,f,c,l,a;for(t.updateButtonText(),n=n||{},t.cfg=n,n.width&&(s=n.width),n.height&&(h=n.height),t.minWidth=n.minWidth||t.defaultMinWidth,t.maxWidth=n.maxWidth||t.defaultMaxWidth,t.minHeight=n.minHeight||t.defaultMinHeight,t.maxHeight=n.maxHeight||t.defaultMaxHeight,u&&(o=u.resizeTracker,u.minWidth=o.minWidth=t.minWidth,u.maxWidth=o.maxWidth=t.maxWidth,u.minHeight=o.minHeight=t.minHeight,u.maxHeight=o.maxHeight=t.maxHeight),delete t.defaultFocus,n.defaultFocus&&(t.defaultFocus=n.defaultFocus),t.animateTarget=n.animateTarget||undefined,t.modal=n.modal!==!1,t.setTitle(n.title||""),t.setIconCls(n.iconCls||""),Ext.isObject(n.buttons)?(t.buttonText=n.buttons,e=0):(t.buttonText=n.buttonText||t.buttonText,e=Ext.isNumber(n.buttons)?n.buttons:0),e=e|t.updateButtonText(),t.buttonText=y,Ext.suspendLayouts(),delete t.width,delete t.height,(s||h)&&(s&&t.setWidth(s),h&&t.setHeight(h)),t.hidden=!1,t.rendered||t.render(Ext.getBody()),t.closable=n.closable!==!1&&!n.wait,t.header.child("[type=close]").setVisible(t.closable),n.title||t.closable||n.iconCls?t.header.show():t.header.hide(),t.liveDrag=!n.proxyDrag,t.userCallback=Ext.Function.bind(n.callback||n.fn||Ext.emptyFn,n.scope||Ext.global),t.setIcon(n.icon,n.iconWidth,n.iconHeight),c=t.msg,n.msg?(c.setValue(n.msg),c.show()):c.hide(),r=t.textArea,f=t.textField,n.prompt||n.multiline?(t.multiline=n.multiline,n.multiline?(r.setValue(n.value),r.setHeight(n.defaultTextHeight||t.defaultTextHeight),r.show(),f.hide(),t.defaultFocus=r):(f.setValue(n.value),r.hide(),f.show(),t.defaultFocus=f)):(r.hide(),f.hide()),l=t.progressBar,n.progress||n.wait?(l.show(),t.updateProgress(0,n.progressText),n.wait===!0&&l.wait(n.waitConfig)):l.hide(),a=t.msgButtons,i=0;i<4;i++)e&Math.pow(2,i)?(t.defaultFocus||(t.defaultFocus=a[i]),a[i].show(),v=!1):a[i].hide();v?t.bottomTb.hide():t.bottomTb.show();Ext.resumeLayouts(!0)},updateButtonText:function(){var t=this,i=t.buttonText,u=0,n,r;for(n in i)i.hasOwnProperty(n)&&(r=t.msgButtons[n],r&&(t.cfg&&t.cfg.buttonText&&(u=u|Math.pow(2,Ext.Array.indexOf(t.buttonIds,n))),r.text!=i[n]&&r.setText(i[n])));return u},show:function(n){var t=this,i;if(Ext.AbstractComponent.layoutSuspendCount){Ext.on({resumelayouts:function(){t.show(n)},single:!0});return t}return t.reconfigure(n),n.cls&&t.addCls(n.cls),i=t.query("textfield:not([hidden]),textarea:not([hidden]),button:not([hidden])"),t.preventFocusOnActivate=!i.length,t.hidden=!0,t.callParent(),t},onShow:function(){this.callParent(arguments);this.center()},updateText:function(n){this.msg.setValue(n)},setIcon:function(n,t,i){var u=this,r=u.iconComponent,f=u.messageIconCls;return f&&r.removeCls(f),n?(r.show(),r.setSize(t||u.iconWidth,i||u.iconHeight),r.addCls(Ext.baseCSSPrefix+"dlg-icon"),r.addCls(u.messageIconCls=n)):(r.removeCls(Ext.baseCSSPrefix+"dlg-icon"),r.hide()),u},updateProgress:function(n,t,i){return this.progressBar.updateProgress(n,t),i&&this.updateText(i),this},onEsc:function(){this.closable!==!1&&this.callParent(arguments)},confirm:function(n,t,i,r){return Ext.isString(n)&&(n={title:n,icon:this.QUESTION,msg:t,buttons:this.YESNO,callback:i,scope:r}),this.show(n)},prompt:function(n,t,i,r,u,f){return Ext.isString(n)&&(n={prompt:!0,title:n,minWidth:this.minPromptWidth,msg:t,buttons:this.OKCANCEL,callback:i,scope:r,multiline:u,value:f}),this.show(n)},wait:function(n,t,i){return Ext.isString(n)&&(n={title:t,msg:n,closable:!1,wait:!0,modal:!0,minWidth:this.minProgressWidth,waitConfig:i}),this.show(n)},alert:function(n,t,i,r){return Ext.isString(n)&&(n={title:n,msg:t,buttons:this.OK,fn:i,scope:r,minWidth:this.minWidth}),this.show(n)},progress:function(n,t,i){return Ext.isString(n)&&(n={title:n,msg:t,progress:!0,progressText:i}),this.show(n)}},function(){Ext.MessageBox=Ext.Msg=new this})