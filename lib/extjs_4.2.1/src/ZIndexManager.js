Ext.define("Ext.ZIndexManager",{alternateClassName:"Ext.WindowGroup",statics:{zBase:9e3},constructor:function(n){var t=this;if(t.list={},t.zIndexStack=[],t.front=null,n)if(n.isContainer){n.on("resize",t._onContainerResize,t);t.zseed=Ext.Number.from(t.rendered?n.getEl().getStyle("zIndex"):undefined,t.getNextZSeed());t.targetEl=n.getTargetEl();t.container=n}else{Ext.EventManager.onWindowResize(t._onContainerResize,t);t.zseed=t.getNextZSeed();t.targetEl=Ext.get(n)}else{Ext.EventManager.onWindowResize(t._onContainerResize,t);t.zseed=t.getNextZSeed();Ext.onDocumentReady(function(){t.targetEl=Ext.getBody()})}},getNextZSeed:function(){return Ext.ZIndexManager.zBase+=1e4},setBase:function(n){this.zseed=n;var t=this.assignZIndices();return this._activateLast(),t},assignZIndices:function(){for(var u=this.zIndexStack,f=u.length,t=0,i=this.zseed,n,r;t<f;t++)n=u[t],n&&!n.hidden&&(i=n.setZIndex(i),n.modal&&(r=n));return r&&this._showModalMask(r),i},_setActiveChild:function(n,t){var i=this.front,r=n.preventFocusOnActivate;n!==i&&(i&&!i.destroying&&i.setActive(!1,n),this.front=n,n&&n!=t&&(n.preventFocusOnActivate=n.preventFocusOnActivate||t&&(t.preventFocusOnActivate||!t.focusOnToFront),n.setActive(!0),n.modal&&this._showModalMask(n),n.preventFocusOnActivate=r))},onComponentHide:function(){this._activateLast()},_activateLast:function(){for(var n=this,r=n.zIndexStack,t=r.length-1,i;t>=0&&r[t].hidden;--t);if(i=r[t]){if(n._setActiveChild(i,n.front),i.modal)return}else n.front&&!n.front.destroying&&n.front.setActive(!1),n.front=null;for(;t>=0;--t)if(i=r[t],i.isVisible()&&i.modal){n._showModalMask(i);return}n._hideModalMask()},_showModalMask:function(n){var i=this,f=n.el.getStyle("zIndex")-4,e=n.floatParent?n.floatParent.getTargetEl():n.container,t=i.mask,r=i.maskShim,u;if(!t){Ext.isIE6&&(r=i.maskShim=Ext.getBody().createChild({tag:"iframe",cls:Ext.baseCSSPrefix+"shim "+Ext.baseCSSPrefix+"mask-shim"}),r.setVisibilityMode(Ext.Element.DISPLAY));t=i.mask=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"mask",style:"height:0;width:0"});t.setVisibilityMode(Ext.Element.DISPLAY);t.on("click",i._onMaskClick,i)}t.maskTarget=e;u=i.getMaskBox();r&&(r.setStyle("zIndex",f),r.show(),r.setBox(u));t.setStyle("zIndex",f);t.show();t.setBox(u)},_hideModalMask:function(){var n=this.mask,t=this.maskShim;n&&n.isVisible()&&(n.maskTarget=undefined,n.hide(),t&&t.hide())},_onMaskClick:function(){this.front&&this.front.focus()},getMaskBox:function(){var n=this.mask.maskTarget;return n.dom===document.body?{height:Math.max(document.body.scrollHeight,Ext.dom.Element.getDocumentHeight()),width:Math.max(document.body.scrollWidth,document.documentElement.clientWidth),x:0,y:0}:n.getBox()},_onContainerResize:function(){var i=this,n=i.mask,t=i.maskShim,r;n&&n.isVisible()&&(n.hide(),t&&t.hide(),r=i.getMaskBox(),t&&(t.setSize(r),t.show()),n.setSize(r),n.show())},register:function(n){var t=this,i=n.afterHide;n.zIndexManager&&n.zIndexManager.unregister(n);n.zIndexManager=t;t.list[n.id]=n;t.zIndexStack.push(n);n.afterHide=function(){i.apply(n,arguments);t.onComponentHide(n)}},unregister:function(n){var t=this,i=t.list;delete n.zIndexManager;i&&i[n.id]&&(delete i[n.id],delete n.afterHide,Ext.Array.remove(t.zIndexStack,n),t._activateLast())},get:function(n){return n.isComponent?n:this.list[n]},bringToFront:function(n,t){var i=this,u=!1,r=i.zIndexStack;return n=i.get(n),n!==i.front&&(Ext.Array.remove(r,n),n.preventBringToFront?r.unshift(n):r.push(n),i.assignZIndices(),t||i._activateLast(),u=!0,i.front=n,n.modal&&i._showModalMask(n)),u},sendToBack:function(n){var t=this;return n=t.get(n),Ext.Array.remove(t.zIndexStack,n),t.zIndexStack.unshift(n),t.assignZIndices(),this._activateLast(),n},hideAll:function(){var t=this.list,n;for(var i in t)t.hasOwnProperty(i)&&(n=t[i],n.isComponent&&n.isVisible()&&n.hide())},hide:function(){var t=0,i=this.zIndexStack,r=i.length,n;for(this.tempHidden=[];t<r;t++)n=i[t],n.isVisible()&&(this.tempHidden.push(n),n.el.hide(),n.hidden=!0)},show:function(){for(var t=0,i=this.tempHidden,r=i?i.length:0,n;t<r;t++)n=i[t],n.el.show(),n.hidden=!1,n.setPosition(n.x,n.y);delete this.tempHidden},getActive:function(){return this.front},getBy:function(n,t){for(var u=[],r=0,f=this.zIndexStack,e=f.length,i;r<e;r++)i=f[r],n.call(t||i,i)!==!1&&u.push(i);return u},each:function(n,t){var r=this.list,u,i;for(u in r)if(r.hasOwnProperty(u)&&(i=r[u],i.isComponent&&n.call(t||i,i)===!1))return},eachBottomUp:function(n,t){for(var u=this.zIndexStack,r=0,f=u.length,i;r<f;r++)if(i=u[r],i.isComponent&&n.call(t||i,i)===!1)return},eachTopDown:function(n,t){for(var r=this.zIndexStack,u=r.length,i;u-->0;)if(i=r[u],i.isComponent&&n.call(t||i,i)===!1)return},destroy:function(){var n=this,t=n.list,i;for(var r in t)t.hasOwnProperty(r)&&(i=t[r],i.isComponent&&i.destroy());delete n.zIndexStack;delete n.list;delete n.container;delete n.targetEl}},function(){Ext.WindowManager=Ext.WindowMgr=new this})