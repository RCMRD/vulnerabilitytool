Ext.define("Ext.chart.series.Radar",{extend:"Ext.chart.series.Series",requires:["Ext.chart.Shape","Ext.fx.Anim"],type:"radar",alias:"series.radar",rad:Math.PI/180,showInLegend:!1,style:{},constructor:function(){this.callParent(arguments);var n=this,t=n.chart.surface;n.group=t.getGroup(n.seriesId);n.showMarkers&&(n.markerGroup=t.getGroup(n.seriesId+"-markers"))},drawSeries:function(){var n=this,v=n.chart.getChartStore(),g=v.data.items,y,l,ht=n.group,i=n.chart,nt=i.series.items,p,tt,it,ct=n.field||n.yField,lt=i.surface,r=i.chartBBox,rt=n.colorArrayStyle,u,f,ut,ft,e=0,b=[],at=Math.max,vt=Math.cos,yt=Math.sin,et=Math.PI*2,w=v.getCount(),a,o,s,h,k,t,ot,c=n.seriesStyle,d=i.axes&&i.axes.get(0),st=!(d&&d.maximum);if(n.setBBox(),e=st?0:d.maximum||0,Ext.apply(c,n.style||{}),!v||!v.getCount()||n.seriesIsHidden){n.hide();n.items=[];n.radar&&n.radar.hide(!0);n.radar=null;return}if(c.stroke||(c.stroke=rt[n.themeIdx%rt.length]),n.unHighlightItem(),n.cleanHighlights(),u=n.centerX=r.x+r.width/2,f=n.centerY=r.y+r.height/2,n.radius=ft=Math.min(r.width,r.height)/2,n.items=ut=[],st){for(p=0,tt=nt.length;p<tt;p++)it=nt[p],b.push(it.yField);for(y=0;y<w;y++)for(l=g[y],t=0,ot=b.length;t<ot;t++)e=at(+l.get(b[t]),e)}for(e=e||1,a=[],o=[],t=0;t<w;t++)l=g[t],k=ft*l.get(ct)/e,s=k*vt(t/w*et),h=k*yt(t/w*et),t==0?(o.push("M",s+u,h+f),a.push("M",.01*s+u,.01*h+f)):(o.push("L",s+u,h+f),a.push("L",.01*s+u,.01*h+f)),ut.push({sprite:!1,point:[u+s,f+h],storeItem:l,series:n});if(o.push("Z"),n.radar||(n.radar=lt.add(Ext.apply({type:"path",group:ht,path:a},c||{}))),i.resizing&&n.radar.setAttributes({path:a},!0),i.animate)n.onAnimate(n.radar,{to:Ext.apply({path:o},c||{})});else n.radar.setAttributes(Ext.apply({path:o},c||{}),!0);n.showMarkers&&n.drawMarkers();n.renderLabels();n.renderCallouts()},drawMarkers:function(){var n=this,u=n.chart,v=u.surface,o=u.getChartStore(),y=Ext.apply({},n.markerStyle||{}),f=Ext.apply(y,n.markerConfig,{fill:n.colorArrayStyle[n.themeIdx%n.colorArrayStyle.length]}),s=n.items,p=f.type,h=n.markerGroup,c=n.centerX,l=n.centerY,e,i,a,t,r;for(delete f.type,i=0,a=s.length;i<a;i++)if(e=s[i],t=h.getAt(i),t?t.show():t=Ext.chart.Shape[p](v,Ext.apply({group:h,x:0,y:0,translate:{x:c,y:l}},f)),e.sprite=t,u.resizing&&t.setAttributes({x:0,y:0,translate:{x:c,y:l}},!0),t._to={translate:{x:e.point[0],y:e.point[1]}},r=n.renderer(t,o.getAt(i),t._to,i,o),r=Ext.applyIf(r||{},f||{}),u.animate)n.onAnimate(t,{to:r});else t.setAttributes(r,!0)},isItemInPoint:function(n,t,i){var r,u=10,f=Math.abs;return r=i.point,f(r[0]-n)<=u&&f(r[1]-t)<=u},onCreateLabel:function(){var n=this,t=n.labelsGroup,i=n.label,r=n.centerX,u=n.centerY,f=Ext.apply({},i,n.seriesLabelStyle||{});return n.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:t,x:r,y:u},f||{}))},onPlaceLabel:function(n,t,i,r,u,f,e){function tt(n){return n<0&&(n+=360),n%360}var h=this,p=h.chart,w=p.resizing,a=h.label,b=a.renderer,k=a.field,v=h.centerX,y=h.centerY,s={x:Number(i.point[0]),y:Number(i.point[1])},d=s.x-v,g=s.y-y,nt=Math.atan2(g,d||1),o=nt*180/Math.PI,l,c;if(n.setAttributes({text:b(t.get(k),n,t,i,r,u,f,e),hidden:!0},!0),l=n.getBBox(),o=tt(o),o>45&&o<135||o>225&&o<315?(c=o>45&&o<135?1:-1,s.y+=c*l.height/2):(c=o>=135&&o<=225?-1:1,s.x+=c*l.width/2),w&&n.setAttributes({x:v,y:y},!0),f){n.show(!0);h.onAnimate(n,{to:s})}else n.setAttributes(s,!0),n.show(!0)},toggleAll:function(n){var t=this,i,u,f,r;if(n?Ext.chart.series.Radar.superclass.showAll.call(t):Ext.chart.series.Radar.superclass.hideAll.call(t),t.radar&&(t.radar.setAttributes({hidden:!n},!0),t.radar.shadows))for(i=0,r=t.radar.shadows,u=r.length;i<u;i++)f=r[i],f.setAttributes({hidden:!n},!0)},hideAll:function(){this.toggleAll(!1);this.hideMarkers(0)},showAll:function(){this.toggleAll(!0)},hideMarkers:function(n){for(var t=this,r=t.markerGroup&&t.markerGroup.getCount()||0,i=n||0;i<r;i++)t.markerGroup.getAt(i).hide(!0)},getAxesForXAndYFields:function(){var t=this,i=t.chart,n=i.axes,r=[].concat(n&&n.get(0));return{yAxis:r}}})