Ext.define("Ext.selection.DataViewModel",{extend:"Ext.selection.Model",requires:["Ext.util.KeyNav"],deselectOnContainerClick:!0,enableKeyNav:!0,constructor:function(){this.addEvents("beforedeselect","beforeselect","deselect","select");this.callParent(arguments)},bindComponent:function(n){var t=this,i={refresh:t.refresh,scope:t};t.view=n;t.bindStore(n.getStore());i[n.triggerEvent]=t.onItemClick;i[n.triggerCtEvent]=t.onContainerClick;n.on(i);t.enableKeyNav&&t.initKeyNav(n)},onUpdate:function(n){var t=this.view;if(t&&this.isSelected(n))t.onItemSelect(n)},onItemClick:function(n,t,i,r,u){this.selectWithEvent(t,u)},onContainerClick:function(){this.deselectOnContainerClick&&this.deselectAll()},initKeyNav:function(n){var t=this;if(!n.rendered){n.on({render:Ext.Function.bind(t.initKeyNav,t,[n]),single:!0});return}n.el.set({tabIndex:-1});t.keyNav=new Ext.util.KeyNav({target:n.el,ignoreInputFields:!0,down:Ext.pass(t.onNavKey,[1],t),right:Ext.pass(t.onNavKey,[1],t),left:Ext.pass(t.onNavKey,[-1],t),up:Ext.pass(t.onNavKey,[-1],t),scope:t})},onNavKey:function(n){n=n||1;var i=this,r=i.view,u=i.getSelection()[0],f=i.view.store.getCount(),t;t=u?r.indexOf(r.getNode(u))+n:0;t<0?t=f-1:t>=f&&(t=0);i.select(t)},onSelectChange:function(n,t,i,r){var u=this,f=u.view,e=t?"select":"deselect";if((i||u.fireEvent("before"+e,u,n))!==!1&&r()!==!1){if(f)if(t)f.onItemSelect(n);else f.onItemDeselect(n);i||u.fireEvent(e,u,n)}},onLastFocusChanged:function(n,t,i){var r=this.view;r&&!i&&t&&(r.focusNode(t),this.fireEvent("focuschange",this,n,t))},destroy:function(){Ext.destroy(this.keyNav);this.callParent()}})