Ext.define("Ext.draw.Sprite",{mixins:{observable:"Ext.util.Observable",animate:"Ext.util.Animate"},requires:["Ext.draw.SpriteDD"],dirty:!1,dirtyHidden:!1,dirtyTransform:!1,dirtyPath:!0,dirtyFont:!0,zIndexDirty:!0,isSprite:!0,zIndex:0,fontProperties:["font","font-size","font-weight","font-style","font-family","text-anchor","text"],pathProperties:["x","y","d","path","height","width","radius","r","rx","ry","cx","cy"],constructor:function(n){var t=this;n=Ext.merge({},n||{});t.id=Ext.id(null,"ext-sprite-");t.transformations=[];Ext.copyTo(this,n,"surface,group,type,draggable");t.bbox={};t.attr={zIndex:0,translation:{x:null,y:null},rotation:{degrees:null,x:null,y:null},scaling:{x:null,y:null,cx:null,cy:null}};delete n.surface;delete n.group;delete n.type;delete n.draggable;t.setAttributes(n);t.addEvents("beforedestroy","destroy","render","mousedown","mouseup","mouseover","mouseout","mousemove","click");t.mixins.observable.constructor.apply(this,arguments)},initDraggable:function(){var n=this;n.el||n.surface.createSpriteElement(n);n.dd=new Ext.draw.SpriteDD(n,Ext.isBoolean(n.draggable)?null:n.draggable);n.on("beforedestroy",n.dd.destroy,n.dd)},setAttributes:function(n,t){var i=this,y=i.fontProperties,b=y.length,p=i.pathProperties,k=p.length,w=!!i.surface,v=w&&i.surface.customAttributes||{},f=i.attr,a=!1,u,s,h,l,e,c,r,o;n=Ext.apply({},n);for(u in v)n.hasOwnProperty(u)&&typeof v[u]=="function"&&Ext.apply(n,v[u].apply(i,[].concat(n[u])));for(!!n.hidden!=!!f.hidden&&(i.dirtyHidden=!0),s=0;s<k;s++)if(u=p[s],u in n&&n[u]!==f[u]){i.dirtyPath=!0;a=!0;break}for(("zIndex"in n)&&(i.zIndexDirty=!0),("text"in n)&&(i.dirtyFont=!0,a=!0),s=0;s<b;s++)if(u=y[s],u in n&&n[u]!==f[u]){i.dirtyFont=!0;a=!0;break}return h=n.translation||n.translate,delete n.translate,delete n.translation,l=f.translation,h&&("x"in h&&h.x!==l.x||"y"in h&&h.y!==l.y)&&(i.dirtyTransform=!0,l.x=h.x,l.y=h.y),e=n.rotation||n.rotate,c=f.rotation,delete n.rotate,delete n.rotation,e&&("x"in e&&e.x!==c.x||"y"in e&&e.y!==c.y||"degrees"in e&&e.degrees!==c.degrees)&&(i.dirtyTransform=!0,c.x=e.x,c.y=e.y,c.degrees=e.degrees),r=n.scaling||n.scale,o=f.scaling,delete n.scale,delete n.scaling,r&&("x"in r&&r.x!==o.x||"y"in r&&r.y!==o.y||"cx"in r&&r.cx!==o.cx||"cy"in r&&r.cy!==o.cy)&&(i.dirtyTransform=!0,o.x=r.x,o.y=r.y,o.cx=r.cx,o.cy=r.cy),!i.dirtyTransform&&a&&(f.scaling.x===null||f.scaling.y===null||f.rotation.y===null||f.rotation.y===null)&&(i.dirtyTransform=!0),Ext.apply(f,n),i.dirty=!0,t===!0&&w&&i.redraw(),this},getBBox:function(){return this.surface.getBBox(this)},setText:function(n){return this.surface.setText(this,n)},hide:function(n){return this.setAttributes({hidden:!0},n),this},show:function(n){return this.setAttributes({hidden:!1},n),this},remove:function(){return this.surface?(this.surface.remove(this),!0):!1},onRemove:function(){this.surface.onRemove(this)},destroy:function(){var n=this;if(n.fireEvent("beforedestroy",n)!==!1){n.remove();n.surface.onDestroy(n);n.clearListeners();n.fireEvent("destroy")}},redraw:function(){return this.surface.renderItem(this),this},setStyle:function(){return this.el.setStyle.apply(this.el,arguments),this},addCls:function(n){return this.surface.addCls(this,n),this},removeCls:function(n){return this.surface.removeCls(this,n),this}})