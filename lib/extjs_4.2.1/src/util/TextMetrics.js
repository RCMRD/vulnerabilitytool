Ext.define("Ext.util.TextMetrics",{statics:{shared:null,measure:function(n,t,i){var u=this,r=u.shared;return r||(r=u.shared=new u(n,i)),r.bind(n),r.setFixedWidth(i||"auto"),r.getSize(t)},destroy:function(){var n=this;Ext.destroy(n.shared);n.shared=null}},constructor:function(n,t){var r=this,i=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"textmetrics"});r.measure=i;n&&r.bind(n);i.position("absolute");i.setLocalXY(-1e3,-1e3);i.hide();t&&i.setWidth(t)},getSize:function(n){var t=this.measure,i;return t.update(n),i=t.getSize(),t.update(""),i},bind:function(n){var t=this;t.el=Ext.get(n);t.measure.setStyle(t.el.getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(n){this.measure.setWidth(n)},getWidth:function(n){return this.measure.dom.style.width="auto",this.getSize(n).width},getHeight:function(n){return this.getSize(n).height},destroy:function(){var n=this;n.measure.remove();delete n.el;delete n.measure}},function(){Ext.Element.addMethods({getTextWidth:function(n,t,i){return Ext.Number.constrain(Ext.util.TextMetrics.measure(this.dom,Ext.value(n,this.dom.innerHTML,!0)).width,t||0,i||1e6)}})})