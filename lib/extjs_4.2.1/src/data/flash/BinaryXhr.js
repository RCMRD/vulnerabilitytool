Ext.define("Ext.data.flash.BinaryXhr",{statics:{flashPluginActivated:function(){Ext.data.flash.BinaryXhr.flashPluginActive=!0;Ext.data.flash.BinaryXhr.flashPlugin=document.getElementById("ext-flash-polyfill");Ext.globalEvents.fireEvent("flashready")},flashPluginActive:!1,flashPluginInjected:!1,connectionIndex:1,liveConnections:{},flashPlugin:null,onFlashStateChange:function(n,t,i){var r;if(r=this.liveConnections[Number(n)],r)r.onFlashStateChange(t,i);else Ext.warn.log("onFlashStateChange for unknown connection ID: "+n)},registerConnection:function(n){var t=this.connectionIndex;return this.conectionIndex=this.connectionIndex+1,this.liveConnections[t]=n,t},injectFlashPlugin:function(){var n,r,u,t,e=this,f,i;t=document.createElement("img");t.setAttribute("src",window.location.protocol+"//www.adobe.com/images/shared/download_buttons/get_flash_player.gif");t.setAttribute("alt","Get Adobe Flash player");u=document.createElement("a");u.setAttribute("href","http://www.adobe.com/go/getflashplayer");u.appendChild(t);r=document.createElement("p");r.innerHTML="To view this page ensure that Adobe Flash Player version 11.1.0 or greater is installed.";n=document.createElement("div");n.setAttribute("id","ext-flash-polyfill");n.appendChild(r);n.appendChild(t);Ext.getBody().dom.appendChild(n);f=[Ext.Loader.getPath("Ext.data.Connection"),"../../../plugins/flash/swfobject.js"].join("/");i="/plugins/flash/FlashPlugin.swf";i=[Ext.Loader.getPath("Ext.data.Connection"),"../../plugins/flash/FlashPlugin.swf"].join("/");Ext.flashPluginPath&&(i=Ext.flashPluginPath);Ext.Loader.loadScript({url:f,onLoad:function(){var n={},t;n.quality="high";n.bgcolor="#ffffff";n.allowscriptaccess="sameDomain";n.allowfullscreen="true";t={};t.id="ext-flash-polyfill";t.name="polyfill";t.align="middle";swfobject.embedSWF(i,"ext-flash-polyfill","0","0","11.4.0","playerProductInstall.swf",{},n,t)},onError:function(){Ext.Error.raise("Could not load flash-loader file swfobject.js from "+flashLoader)},scope:e});Ext.globalEvents.addEvents("flashready");Ext.data.flash.BinaryXhr.flashPluginInjected=!0}},readyState:0,status:0,statusText:"",responseBytes:null,javascriptId:null,constructor:function(n){Ext.data.flash.BinaryXhr.flashPluginInjected||Ext.data.flash.BinaryXhr.injectFlashPlugin();var t=this;Ext.apply(t,n);t.requestHeaders={}},abort:function(){var n=this;if(n.readyState==4){Ext.warn.log("Aborting a connection that's completed its transfer: "+this.url);return}if(n.aborted=!0,!Ext.data.flash.BinaryXhr.flashPluginActive){Ext.globalEvents.removeListener("flashready",n.onFlashReady,n);return}Ext.data.flash.BinaryXhr.flashPlugin.abortRequest(n.javascriptId);delete Ext.data.flash.BinaryXhr.liveConnections[n.javascriptId]},getAllResponseHeaders:function(){var n=[];return Ext.Object.each(this.responseHeaders,function(t,i){n.push(t+": "+i)}),n.join("\r\n")},getResponseHeader:function(n){var t=this.responseHeaders;return t&&t[n]||null},open:function(n,t,i,r,u){var f=this;f.method=n;f.url=t;f.async=i!==!1;f.user=r;f.password=u;f.async||Ext.Error.raise("Binary posts are only supported in async mode: "+t);f.method!="POST"&&Ext.log.warn("Binary data can only be sent as a POST request: "+t)},overrideMimeType:function(n){this.mimeType=n},send:function(n){var t=this;t.body=n;Ext.data.flash.BinaryXhr.flashPluginActive?this.onFlashReady():Ext.globalEvents.addListener("flashready",t.onFlashReady,t)},onFlashReady:function(){var n=this,t,i;n.javascriptId=Ext.data.flash.BinaryXhr.registerConnection(n);t={method:n.method,url:n.url,user:n.user,password:n.password,mimeType:n.mimeType,requestHeaders:n.requestHeaders,body:n.body,javascriptId:n.javascriptId};i=Ext.data.flash.BinaryXhr.flashPlugin.postBinary(t)},setReadyState:function(n){var t=this;t.readyState!=n&&(t.readyState=n,t.onreadystatechange())},setRequestHeader:function(n,t){this.requestHeaders[n]=t},onreadystatechange:Ext.emptyFn,parseData:function(n){var t=this;this.status=n.status||0;t.responseHeaders={};t.mimeType&&(t.responseHeaders["content-type"]=t.mimeType);n.reason=="complete"?(this.responseBytes=n.data,t.responseHeaders["content-length"]=n.data.length):n.reason=="error"||n.reason=="securityError"?(this.statusText=n.text,t.responseHeaders["content-length"]=0):Ext.Error.raise("Unkown reason code in data: "+n.reason)},onFlashStateChange:function(n,t){var i=this;n==4&&(i.parseData(t),delete Ext.data.flash.BinaryXhr.liveConnections[i.javascriptId]);i.setReadyState(n)}})