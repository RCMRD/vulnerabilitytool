Ext.define("Ext.data.writer.Json",{extend:"Ext.data.writer.Writer",alternateClassName:"Ext.data.JsonWriter",alias:"writer.json",root:undefined,encode:!1,allowSingle:!0,expandData:!1,getExpandedData:function(n){for(var o=n.length,e=0,t,r,i,u,f,s=function(n,t){var i={};return i[n]=t,i};e<o;e++){t=n[e];for(r in t)if(t.hasOwnProperty(r)&&(i=r.split("."),u=i.length-1,u>0)){for(f=t[r];u>0;u--)f=s(i[u],f);t[i[0]]=t[i[0]]||{};Ext.Object.merge(t[i[0]],f);delete t[r]}}return n},writeRecords:function(n,t){var i=this.root;return this.expandData&&(t=this.getExpandedData(t)),this.allowSingle&&t.length===1&&(t=t[0]),this.encode?i?n.params[i]=Ext.encode(t):Ext.Error.raise("Must specify a root when using encode"):(n.jsonData=n.jsonData||{},i?n.jsonData[i]=t:n.jsonData=t),n}})