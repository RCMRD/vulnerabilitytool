Ext.define("Ext.data.proxy.Server",{extend:"Ext.data.proxy.Proxy",alias:"proxy.server",alternateClassName:"Ext.data.ServerProxy",uses:["Ext.data.Request"],pageParam:"page",startParam:"start",limitParam:"limit",groupParam:"group",groupDirectionParam:"groupDir",sortParam:"sort",filterParam:"filter",directionParam:"dir",idParam:"id",simpleSortMode:!1,simpleGroupMode:!1,noCache:!0,cacheString:"_dc",timeout:3e4,constructor:function(n){var t=this;n=n||{};t.callParent([n]);t.extraParams=n.extraParams||{};t.api=Ext.apply({},n.api||t.api);t.nocache=t.noCache},create:function(){return this.doRequest.apply(this,arguments)},read:function(){return this.doRequest.apply(this,arguments)},update:function(){return this.doRequest.apply(this,arguments)},destroy:function(){return this.doRequest.apply(this,arguments)},setExtraParam:function(n,t){this.extraParams[n]=t},buildRequest:function(n){var t=this,r=n.params=Ext.apply({},n.params,t.extraParams),i;return Ext.applyIf(r,t.getParams(n)),n.id!==undefined&&r[t.idParam]===undefined&&(r[t.idParam]=n.id),i=new Ext.data.Request({params:r,action:n.action,records:n.records,operation:n,url:n.url,proxy:t}),i.url=t.buildUrl(i),n.request=i,i},processResponse:function(n,t,i,r,u,f){var e=this,s,o;n===!0?(s=e.getReader(),s.applyDefaults=t.action==="read",o=s.read(e.extractResponseData(r)),o.success!==!1?(Ext.apply(t,{response:r,resultSet:o}),t.commitRecords(o.records),t.setCompleted(),t.setSuccessful()):(t.setException(o.message),e.fireEvent("exception",this,r,t))):(e.setException(t,r),e.fireEvent("exception",this,r,t));typeof u=="function"&&u.call(f||e,t);e.afterRequest(i,n)},setException:function(n,t){n.setException({status:t.status,statusText:t.statusText})},extractResponseData:Ext.identityFn,applyEncoding:function(n){return Ext.encode(n)},encodeSorters:function(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]={property:n[t].property,direction:n[t].direction};return this.applyEncoding(i)},encodeFilters:function(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]={property:n[t].property,value:n[t].value};return this.applyEncoding(i)},getParams:function(n){var t=this,i={},e=Ext.isDefined,u=n.groupers,r=n.sorters,o=n.filters,l=n.page,a=n.start,v=n.limit,k=t.simpleSortMode,d=t.simpleGroupMode,y=t.pageParam,p=t.startParam,w=t.limitParam,s=t.groupParam,g=t.groupDirectionParam,h=t.sortParam,b=t.filterParam,nt=t.directionParam,c,f;return y&&e(l)&&(i[y]=l),p&&e(a)&&(i[p]=a),w&&e(v)&&(i[w]=v),c=s&&u&&u.length>0,c&&(d?(i[s]=u[0].property,i[g]=u[0].direction||"ASC"):i[s]=t.encodeSorters(u)),h&&r&&r.length>0&&(k?(f=0,r.length>1&&c&&(f=1),i[h]=r[f].property,i[nt]=r[f].direction):i[h]=t.encodeSorters(r)),b&&o&&o.length>0&&(i[b]=t.encodeFilters(o)),i},buildUrl:function(n){var i=this,t=i.getUrl(n);return t||Ext.Error.raise("You are using a ServerProxy but have not supplied it with a url."),i.noCache&&(t=Ext.urlAppend(t,Ext.String.format("{0}={1}",i.cacheString,Ext.Date.now()))),t},getUrl:function(n){return n.url||this.api[n.action]||this.url},doRequest:function(){Ext.Error.raise("The doRequest function has not been implemented on your Ext.data.proxy.Server subclass. See src/data/ServerProxy.js for details")},afterRequest:Ext.emptyFn,onDestroy:function(){Ext.destroy(this.reader,this.writer)}})