Ext.define("Ext.data.NodeInterface",{requires:["Ext.data.Field","Ext.data.writer.Json"],statics:{decorate:function(n){var t,i,r;(typeof n=="string"?n=Ext.ModelManager.getModel(n):n.isModel&&(n=Ext.ModelManager.getModel(n.modelName)),n.prototype.isNode)||(t=n.prototype.idProperty,i=n.prototype.fields.get(t),r=n.prototype.fields.get(t).type.type,n.override(this.getPrototypeBody()),this.applyFields(n,[{name:"parentId",type:r,defaultValue:null,useNull:i.useNull},{name:"index",type:"int",defaultValue:0,persist:!1,convert:null},{name:"depth",type:"int",defaultValue:0,persist:!1,convert:null},{name:"expanded",type:"bool",defaultValue:!1,persist:!1,convert:null},{name:"expandable",type:"bool",defaultValue:!0,persist:!1,convert:null},{name:"checked",type:"auto",defaultValue:null,persist:!1,convert:null},{name:"leaf",type:"bool",defaultValue:!1},{name:"cls",type:"string",defaultValue:"",persist:!1,convert:null},{name:"iconCls",type:"string",defaultValue:"",persist:!1,convert:null},{name:"icon",type:"string",defaultValue:"",persist:!1,convert:null},{name:"root",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"isLast",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"isFirst",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"allowDrop",type:"boolean",defaultValue:!0,persist:!1,convert:null},{name:"allowDrag",type:"boolean",defaultValue:!0,persist:!1,convert:null},{name:"loaded",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"loading",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"href",type:"string",defaultValue:"",persist:!1,convert:null},{name:"hrefTarget",type:"string",defaultValue:"",persist:!1,convert:null},{name:"qtip",type:"string",defaultValue:"",persist:!1,convert:null},{name:"qtitle",type:"string",defaultValue:"",persist:!1,convert:null},{name:"qshowDelay",type:"int",defaultValue:0,persist:!1,convert:null},{name:"children",type:"auto",defaultValue:null,persist:!1,convert:null}]))},applyFields:function(n,t){for(var f=n.prototype,u=f.fields,e=u.keys,o=t.length,r,i=0;i<o;i++)r=t[i],Ext.Array.contains(e,r.name)||u.add(new Ext.data.Field(r))},getPrototypeBody:function(){var n={idchanged:!0,append:!0,remove:!0,move:!0,insert:!0,beforeappend:!0,beforeremove:!0,beforemove:!0,beforeinsert:!0,expand:!0,collapse:!0,beforeexpand:!0,beforecollapse:!0,sort:!0,rootchange:!0};return{isNode:!0,constructor:function(){var n=this;return n.callParent(arguments),n.firstChild=n.lastChild=n.parentNode=n.previousSibling=n.nextSibling=null,n.childNodes=[],n},createNode:function(n){return n.isModel||(n=Ext.ModelManager.create(n,this.modelName)),n.childNodes||(n.firstChild=n.lastChild=n.parentNode=n.previousSibling=n.nextSibling=null,n.childNodes=[]),n},isLeaf:function(){return this.get("leaf")===!0},setFirstChild:function(n){this.firstChild=n},setLastChild:function(n){this.lastChild=n},updateInfo:function(n,t){var i=this,c=i.data.depth,o={},s=i.childNodes,l=s.length,u,a=i.phantom,h=i[i.persistenceProperty],r,f,e;t||Ext.Error.raise("NodeInterface expects update info to be passed");for(r in t)e=i.fields.get(r),f=t[r],e&&e.persist&&(i.dirty=i.dirty||!i.isEqual(h[r],f)),h[r]=f;if(n&&(i.commit(),i.phantom=a),i.data.depth!==c)for(o={depth:i.data.depth+1},u=0;u<l;u++)s[u].updateInfo(n,o)},isLast:function(){return this.get("isLast")},isFirst:function(){return this.get("isFirst")},hasChildNodes:function(){return!this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){var n=this;return n.get("expandable")?!(n.isLeaf()||n.isLoaded()&&!n.hasChildNodes()):!1},triggerUIUpdate:function(){this.afterEdit([])},appendChild:function(n,t,i){var r=this,o,s,u,f,e,h={isLast:!0,parentId:r.getId(),depth:(r.data.depth||0)+1};if(Ext.isArray(n)){for(r.callStore("suspendAutoSync"),o=0,s=n.length-1;o<s;o++)r.appendChild(n[o],t,i);r.callStore("resumeAutoSync");r.appendChild(n[s],t,i)}else{if(n=r.createNode(n),t!==!0&&r.fireEventArgs("beforeappend",[r,n])===!1)return!1;if(u=r.childNodes.length,f=n.parentNode,f){if(t!==!0&&n.fireEventArgs("beforemove",[n,f,r,u])===!1)return!1;f.removeChild(n,!1,!1,!0)}return Ext.suspendLayouts(),u=r.childNodes.length,u===0&&r.setFirstChild(n),r.childNodes[u]=n,n.parentNode=r,n.nextSibling=null,r.setLastChild(n),e=r.childNodes[u-1],e?(n.previousSibling=e,e.nextSibling=n,e.updateInfo(i,{isLast:!1}),e.triggerUIUpdate()):n.previousSibling=null,h.isFirst=u===0,h.index=u,n.updateInfo(i,h),r.isLoaded()?r.childNodes.length===1&&r.triggerUIUpdate():r.set("loaded",!0),u&&r.childNodes[u-1].isExpanded()&&r.childNodes[u-1].cascadeBy(r.triggerUIUpdate),!n.isLeaf()&&n.phantom&&n.set("loaded",!0),Ext.resumeLayouts(!0),t!==!0&&(r.fireEventArgs("append",[r,n,u]),f&&n.fireEventArgs("move",[n,f,r,u])),n}},getOwnerTree:function(){for(var t=this,n;t.parentNode;)t=t.parentNode;return(n=t.store,n&&(n.treeStore&&(n=n.treeStore),n.tree))?n.ownerTree:undefined},removeChild:function(n,t,i,r){var u=this,o=u.indexOf(n),e,s,f;if(o===-1||i!==!0&&u.fireEventArgs("beforeremove",[u,n,!!r])===!1)return!1;if(Ext.suspendLayouts(),Ext.Array.erase(u.childNodes,o,1),u.firstChild===n&&u.setFirstChild(n.nextSibling),u.lastChild===n&&u.setLastChild(n.previousSibling),(f=n.previousSibling)&&(n.previousSibling.nextSibling=n.nextSibling),n.nextSibling)for(n.nextSibling.previousSibling=n.previousSibling,o===0&&n.nextSibling.updateInfo(!1,{isFirst:!0}),e=o,s=u.childNodes.length;e<s;e++)u.childNodes[e].updateInfo(!1,{index:e});else f&&(f.updateInfo(!1,{isLast:!0}),f.isExpanded()?f.cascadeBy(u.triggerUIUpdate):f.triggerUIUpdate());return u.childNodes.length||u.triggerUIUpdate(),Ext.resumeLayouts(!0),i!==!0&&(n.removeContext={parentNode:n.parentNode,previousSibling:n.previousSibling,nextSibling:n.nextSibling},n.previousSibling=n.nextSibling=n.parentNode=null,u.fireEventArgs("remove",[u,n,!!r]),n.removeContext=null),t?n.destroy(!0):n.clear(),n},copy:function(n,t){var i=this,u=i.callParent(arguments),f=i.childNodes?i.childNodes.length:0,r;if(t)for(r=0;r<f;r++)u.appendChild(i.childNodes[r].copy(undefined,!0));return u},clear:function(n){var t=this;t.parentNode=t.previousSibling=t.nextSibling=null;n&&(t.firstChild=t.lastChild=null)},destroy:function(n){var t=this,u=t.destroyOptions,r=t.childNodes,f=r.length,i;if(n===!0){for(t.clear(!0),i=0;i<f;i++)r[i].destroy(!0);t.childNodes=null;delete t.destroyOptions;t.callParent([u])}else t.destroyOptions=n,t.remove(!0)},insertBefore:function(n,t,i){var r=this,s=r.indexOf(t),f=n.parentNode,u=s,h,o,e;if(!t)return r.appendChild(n);if(n===t||(n=r.createNode(n),i!==!0&&r.fireEventArgs("beforeinsert",[r,n,t])===!1))return!1;if(f===r&&r.indexOf(n)<s&&u--,f){if(i!==!0&&n.fireEventArgs("beforemove",[n,f,r,s,t])===!1)return!1;f.removeChild(n,!1,!1,!0)}for(u===0&&r.setFirstChild(n),Ext.Array.splice(r.childNodes,u,0,n),n.parentNode=r,n.nextSibling=t,t.previousSibling=n,o=r.childNodes[u-1],o?(n.previousSibling=o,o.nextSibling=n):n.previousSibling=null,n.updateInfo(!1,{parentId:r.getId(),index:u,isFirst:u===0,isLast:!1,depth:(r.data.depth||0)+1}),e=u+1,h=r.childNodes.length;e<h;e++)r.childNodes[e].updateInfo(!1,{index:e});return r.isLoaded()?r.childNodes.length===1&&r.triggerUIUpdate():r.set("loaded",!0),!n.isLeaf()&&n.phantom&&n.set("loaded",!0),i!==!0&&(r.fireEventArgs("insert",[r,n,t]),f&&n.fireEventArgs("move",[n,f,r,u,t])),n},insertChild:function(n,t){var i=this.childNodes[n];return i?this.insertBefore(t,i):this.appendChild(t)},remove:function(n,t){var i=this,r=i.parentNode;return r?r.removeChild(i,n,t):n&&i.destroy(!0),i},removeAll:function(n,t,i){var u=this,f=u.childNodes,e=0,o=f.length,r;if(o){for(u.fireEventArgs("bulkremove",[u,f,!1]);e<o;++e)r=f[e],r.removeContext={parentNode:r.parentNode,previousSibling:r.previousSibling,nextSibling:r.nextSibling},r.previousSibling=r.nextSibling=r.parentNode=null,u.fireEventArgs("remove",[u,r,!1]),r.removeContext=null,n?r.destroy(!0):r.removeAll(!1,t,!0);return u.firstChild=u.lastChild=null,i?u.childNodes=null:(u.childNodes.length=0,u.triggerUIUpdate()),u}},getChildAt:function(n){return this.childNodes[n]},replaceChild:function(n,t,i){var r=t?t.nextSibling:null;return this.removeChild(t,!1,i),this.insertBefore(n,r,i),t},indexOf:function(n){return Ext.Array.indexOf(this.childNodes,n)},indexOfId:function(n){for(var i=this.childNodes,r=i.length,t=0;t<r;++t)if(i[t].getId()===n)return t;return-1},getPath:function(n,t){n=n||this.idProperty;t=t||"/";for(var r=[this.get(n)],i=this.parentNode;i;)r.unshift(i.get(n)),i=i.parentNode;return t+r.join(t)},getDepth:function(){return this.get("depth")},bubble:function(n,t,i){for(var r=this;r;){if(n.apply(t||r,i||[r])===!1)break;r=r.parentNode}},cascade:function(){return Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.data.Node: cascade has been deprecated. Please use cascadeBy instead."),this.cascadeBy.apply(this,arguments)},cascadeBy:function(n,t,i){if(n.apply(t||this,i||[this])!==!1)for(var u=this.childNodes,f=u.length,r=0;r<f;r++)u[r].cascadeBy(n,t,i)},eachChild:function(n,t,i){for(var u=this.childNodes,f=u.length,r=0;r<f;r++)if(n.apply(t||this,i||[u[r]])===!1)break},findChild:function(n,t,i){return this.findChildBy(function(){return this.get(n)==t},null,i)},findChildBy:function(n,t,i){for(var e=this.childNodes,o=e.length,u=0,r,f;u<o;u++){if(r=e[u],n.call(t||r,r)===!0)return r;if(i&&(f=r.findChildBy(n,t,i),f!==null))return f}return null},contains:function(n){return n.isAncestor(this)},isAncestor:function(n){for(var t=this.parentNode;t;){if(t===n)return!0;t=t.parentNode}return!1},sort:function(n,t,i){var r=this.childNodes,e=r.length,u,f,o={isFirst:!0};if(e>0){for(Ext.Array.sort(r,n),this.setFirstChild(r[0]),this.setLastChild(r[e-1]),u=0;u<e;u++)f=r[u],f.previousSibling=r[u-1],f.nextSibling=r[u+1],o.isLast=u===e-1,o.index=u,f.updateInfo(!1,o),o.isFirst=!1,t&&!f.isLeaf()&&f.sort(n,!0,!0);i!==!0&&this.fireEventArgs("sort",[this,r])}},isExpanded:function(){return this.get("expanded")},isLoaded:function(){return this.get("loaded")},isLoading:function(){return this.get("loading")},isRoot:function(){return!this.parentNode},isVisible:function(){for(var n=this.parentNode;n;){if(!n.isExpanded())return!1;n=n.parentNode}return!0},expand:function(n,t,i){var r=this,u;if(r.isLeaf())Ext.callback(t,i||r);else if(r.isLoading())r.on("expand",function(){r.expand(n,t,i)},r,{single:!0});else r.isExpanded()?n?(u=r.getOwnerTree(),r.expandChildren(!0,u?u.singleExpand:!1,t,i)):Ext.callback(t,i||r,[r.childNodes]):r.fireEventArgs("beforeexpand",[r,r.onChildNodesAvailable,r,[n,t,i]])},onChildNodesAvailable:function(n,t,i,r){var u=this,f;Ext.suspendLayouts();u.set("expanded",!0);u.fireEventArgs("expand",[u,u.childNodes,!1]);t?(f=u.getOwnerTree(),u.expandChildren(!0,f?f.singleExpand:!1,i,r)):Ext.callback(i,r||u,[u.childNodes]);Ext.resumeLayouts(!0)},expandChildren:function(n,t,i,r){for(var e=this,o=e.childNodes,f=[],s=t?Math.min(o.length,1):o.length,h,u=0;u<s;++u)h=o[u],h.isLeaf()||(f[f.length]=h);for(s=f.length,u=0;u<s;++u)f[u].expand(n);i&&Ext.callback(i,r||e,[e.childNodes])},collapse:function(n,t,i){var r=this,o=r.isExpanded(),e=r.childNodes.length,u,f;if(!r.isLeaf()&&(!o&&n||r.fireEventArgs("beforecollapse",[r])!==!1)){if(Ext.suspendLayouts(),r.isExpanded())n&&(f=function(){for(u=0;u<e;u++)r.childNodes[u].setCollapsed(!0)},t=t?Ext.Function.createSequence(f,t):f),r.set("expanded",!1),r.fireEventArgs("collapse",[r,r.childNodes,!1,t?Ext.Function.bind(t,i,[r.childNodes]):null,null]),t=null;else if(n)for(u=0;u<e;u++)r.childNodes[u].setCollapsed(!0);Ext.resumeLayouts(!0)}Ext.callback(t,i||r,[r.childNodes])},setCollapsed:function(n){var t=this,r=t.childNodes.length,i;if(!t.isLeaf()&&t.fireEventArgs("beforecollapse",[t,Ext.emptyFn])!==!1&&(t.data.expanded=!1,t.fireEventArgs("collapse",[t,t.childNodes,!1,null,null]),n))for(i=0;i<r;i++)t.childNodes[i].setCollapsed(!0)},collapseChildren:function(n,t,i){for(var s=this,o=s.childNodes,f=o.length,e=[],u,r=0;r<f;++r)u=o[r],!u.isLeaf()&&u.isLoaded()&&u.isExpanded()&&e.push(u);for(f=e.length,r=0;r<f;++r)u=e[r],r===f-1?u.collapse(n,t,i):u.collapse(n)},fireEventArgs:function(t,i){var o=Ext.data.Model.prototype.fireEventArgs,r,u,f,e,s;if(n[t]){for(u=this;r!==!1&&u;u=(s=u).parentNode)u.hasListeners[t]&&(r=o.call(u,t,i));return f=s.rootOf,r!==!1&&f&&(e=f.treeStore,e&&e.hasListeners[t]&&(r=e.fireEventArgs.call(e,t,i)),r!==!1&&f.hasListeners[t]&&(r=f.fireEventArgs.call(f,t,i))),r}return o.apply(this,arguments)},serialize:function(){var i=Ext.data.writer.Json.prototype.getRecordData(this),r=this.childNodes,u=r.length,t,n;if(u>0){for(t=[],n=0;n<u;n++)t.push(r[n].serialize());i.children=t}return i}}}}})