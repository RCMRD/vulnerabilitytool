Ext.define("Ext.slider.Multi",{extend:"Ext.form.field.Base",alias:"widget.multislider",alternateClassName:"Ext.slider.MultiSlider",requires:["Ext.slider.Thumb","Ext.slider.Tip","Ext.Number","Ext.util.Format","Ext.Template","Ext.layout.component.field.Slider"],childEls:["endEl","innerEl"],fieldSubTpl:['<div id="{id}" class="'+Ext.baseCSSPrefix+"slider {fieldCls} {vertical}","{childElCls}",'" aria-valuemin="{minValue}" aria-valuemax="{maxValue}" aria-valuenow="{value}" aria-valuetext="{value}">','<div id="{cmpId}-endEl" class="'+Ext.baseCSSPrefix+'slider-end" role="presentation">','<div id="{cmpId}-innerEl" class="'+Ext.baseCSSPrefix+'slider-inner" role="presentation">',"{%this.renderThumbs(out, values)%}","<\/div>","<\/div>","<\/div>",{renderThumbs:function(n,t){for(var u=t.$comp,i=0,f=u.thumbs,o=f.length,e,r;i<o;i++)e=f[i],r=e.getElConfig(),r.id=u.id+"-thumb-"+i,Ext.DomHelper.generateMarkup(r,n)},disableFormats:!0}],horizontalProp:"left",vertical:!1,minValue:0,maxValue:100,decimalPrecision:0,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:!0,animate:!0,dragging:!1,constrainThumbs:!0,componentLayout:"sliderfield",useTips:!0,tipText:null,ariaRole:"slider",initValue:function(){var n=this,t=Ext.value,i=t(n.values,[t(n.value,t(n.minValue,0))]),r=0,u=i.length;for(n.originalValue=i;r<u;r++)n.addThumb(i[r])},initComponent:function(){var n=this,r,u,t,f,i;if(n.thumbs=[],n.keyIncrement=Math.max(n.increment,n.keyIncrement),n.addEvents("beforechange","change","changecomplete","dragstart","drag","dragend"),n.callParent(),n.useTips){for(r=Ext.isObject(n.useTips)?Ext.apply({},n.useTips):n.tipText?{getText:n.tipText}:{},i=n.plugins=n.plugins||[],f=i.length,t=0;t<f;t++)if(i[t].isSliderTip){u=!0;break}u||n.plugins.push(new Ext.slider.Tip(r))}},addThumb:function(n){var t=this,i=new Ext.slider.Thumb({ownerCt:t,ownerLayout:t.getComponentLayout(),value:n,slider:t,index:t.thumbs.length,constrain:t.constrainThumbs,disabled:!!t.readOnly});return t.thumbs.push(i),t.rendered&&i.render(),i},promoteThumb:function(n){for(var r=this.thumbs,u=r.length,t,i=0;i<u;i++)t=r[i],t==n?t.bringToFront():t.sendToBack()},getSubTplData:function(){var n=this;return Ext.apply(n.callParent(),{$comp:n,vertical:n.vertical?Ext.baseCSSPrefix+"slider-vert":Ext.baseCSSPrefix+"slider-horz",minValue:n.minValue,maxValue:n.maxValue,value:n.value,childElCls:""})},onRender:function(){var t=this,r=t.thumbs,u=r.length,n=0,i;for(t.callParent(arguments),n=0;n<u;n++)i=r[n],i.el=t.el.getById(t.id+"-thumb-"+n),i.onRender()},initEvents:function(){var n=this;n.mon(n.el,{scope:n,mousedown:n.onMouseDown,keydown:n.onKeyDown})},onDragStart:Ext.emptyFn,onDragEnd:Ext.emptyFn,getTrackpoint:function(n){var t=this,e=t.vertical,r=t.innerEl,i,u,f;return e?(f="top",i=r.getHeight()):(f=t.horizontalProp,i=r.getWidth()),n=t.transformTrackPoints(r.translatePoints(n)),u=Ext.Number.constrain(n[f],0,i),e?i-u:u},transformTrackPoints:Ext.identityFn,onMouseDown:function(n){var t=this,i=!1,r=0,f=t.thumbs,e=f.length,u;if(!t.disabled){for(;r<e;r++)i=i||n.target==f[r].el.dom;if(t.clickToChange&&!i&&(u=t.getTrackpoint(n.getXY()),u!==undefined))t.onClickChange(u);t.focus()}},onClickChange:function(n){var t=this,i,r;i=t.getNearest(n);i.disabled||(r=i.index,t.setValue(r,Ext.util.Format.round(t.reversePixelValue(n),t.decimalPrecision),undefined,!0))},getNearest:function(n){for(var t=this,s=t.reversePixelValue(n),f=t.getRange()+5,e=null,h=t.thumbs,i=0,c=h.length,r,o,u;i<c;i++)r=t.thumbs[i],o=r.value,u=Math.abs(o-s),Math.abs(u<=f)&&(e=r,f=u);return e},onKeyDown:function(n){var t=this,r,i;if(t.disabled||t.thumbs.length!==1){n.preventDefault();return}r=n.getKey();switch(r){case n.UP:case n.RIGHT:n.stopEvent();i=n.ctrlKey?t.maxValue:t.getValue(0)+t.keyIncrement;t.setValue(0,i,undefined,!0);break;case n.DOWN:case n.LEFT:n.stopEvent();i=n.ctrlKey?t.minValue:t.getValue(0)-t.keyIncrement;t.setValue(0,i,undefined,!0);break;default:n.preventDefault()}},normalizeValue:function(n){var t=this,i=t.zeroBasedSnapping?"snap":"snapInRange";return n=Ext.Number[i](n,t.increment,t.minValue,t.maxValue),n=Ext.util.Format.round(n,t.decimalPrecision),Ext.Number.constrain(n,t.minValue,t.maxValue)},setMinValue:function(n){var t=this,r=t.thumbs,f=r.length,u,i;for(t.minValue=n,t.rendered&&t.inputEl.dom.setAttribute("aria-valuemin",n),i=0;i<f;++i)u=r[i],u.value<n&&t.setValue(i,n,!1);t.syncThumbs()},setMaxValue:function(n){var t=this,r=t.thumbs,f=r.length,u,i;for(t.maxValue=n,t.rendered&&t.inputEl.dom.setAttribute("aria-valuemax",n),i=0;i<f;++i)u=r[i],u.value>n&&t.setValue(i,n,!1);t.syncThumbs()},setValue:function(n,t,i,r){var u=this,h=u.thumbs,f,s,e,o;if(Ext.isArray(n)){for(o=n,i=t,e=0,s=o.length;e<s;++e)f=h[e],f&&u.setValue(e,o[e],i);return u}return f=u.thumbs[n],t=u.normalizeValue(t),t!==f.value&&u.fireEvent("beforechange",u,t,f.value,f)!==!1&&(f.value=t,u.rendered&&(u.inputEl.set({"aria-valuenow":t,"aria-valuetext":t}),f.move(u.calculateThumbPosition(t),Ext.isDefined(i)?i!==!1:u.animate),u.fireEvent("change",u,t,f),u.checkDirty(),r&&u.fireEvent("changecomplete",u,t,f))),u},calculateThumbPosition:function(n){var i=this,r=i.minValue,t=(n-r)/i.getRange()*100;return isNaN(t)&&(t=r),t},getRatio:function(){var n=this,t=n.innerEl,i=n.vertical?t.getHeight():t.getWidth(),r=n.getRange();return r===0?i:i/r},getRange:function(){return this.maxValue-this.minValue},reversePixelValue:function(n){return this.minValue+n/this.getRatio()},reversePercentageValue:function(n){return this.minValue+this.getRange()*(n/100)},onDisable:function(){var n=this,t=0,u=n.thumbs,e=u.length,i,r,f;for(n.callParent();t<e;t++)i=u[t],r=i.el,i.disable(),Ext.isIE&&(f=r.getXY(),r.hide(),n.innerEl.addCls(n.disabledCls).dom.disabled=!0,n.thumbHolder||(n.thumbHolder=n.endEl.createChild({cls:Ext.baseCSSPrefix+"slider-thumb "+n.disabledCls})),n.thumbHolder.show().setXY(f))},onEnable:function(){var n=this,t=0,r=n.thumbs,f=r.length,i,u;for(this.callParent();t<f;t++)i=r[t],u=i.el,i.enable(),Ext.isIE&&(n.innerEl.removeCls(n.disabledCls).dom.disabled=!1,n.thumbHolder&&n.thumbHolder.hide(),u.show(),n.syncThumbs())},syncThumbs:function(){if(this.rendered)for(var t=this.thumbs,i=t.length,n=0;n<i;n++)t[n].move(this.calculateThumbPosition(t[n].value))},getValue:function(n){return Ext.isNumber(n)?this.thumbs[n].value:this.getValues()},getValues:function(){for(var t=[],n=0,i=this.thumbs,r=i.length;n<r;n++)t.push(i[n].value);return t},getSubmitValue:function(){var n=this;return n.disabled||!n.submitValue?null:n.getValue()},reset:function(){for(var n=this,i=[].concat(n.originalValue),t=0,u=i.length,r;t<u;t++)r=i[t],n.setValue(t,r);n.clearInvalid();delete n.wasValid},setReadOnly:function(n){var i=this,r=i.thumbs,u=r.length,t=0;for(i.callParent(arguments),n=i.readOnly;t<u;++t)n?r[t].disable():r[t].enable()},beforeDestroy:function(){var n=this,i=n.thumbs,t=0,u=i.length,r;for(Ext.destroy(n.innerEl,n.endEl,n.focusEl);t<u;t++)r=i[t],Ext.destroy(r);n.callParent()}})