Ext.define("Ext.grid.ColumnLayout",{extend:"Ext.layout.container.HBox",alias:"layout.gridcolumn",type:"gridcolumn",reserveOffset:!1,firstHeaderCls:Ext.baseCSSPrefix+"column-header-first",lastHeaderCls:Ext.baseCSSPrefix+"column-header-last",initLayout:function(){this.scrollbarWidth||(this.self.prototype.scrollbarWidth=Ext.getScrollbarSize().width);this.grid=this.owner.up("[scrollerOwner]");this.callParent()},beginLayout:function(n){var i=this,e=i.owner,f=i.grid,t=f.view,o=i.getVisibleItems(),s=o.length,h=i.firstHeaderCls,c=i.lastHeaderCls,r,u;for(f.lockable&&(t=e.up("tablepanel")===t.normalGrid?t.normalGrid.getView():null),r=0;r<s;r++)u=o[r],u.isLast=!1,u.removeCls([h,c]),r===0&&u.addCls(h),r===s-1&&(u.addCls(c),u.isLast=!0);i.callParent(arguments);!e.isColumn&&Ext.getScrollbarSize().width&&!f.collapsed&&t&&t.rendered&&(n.viewTable=t.body.dom)&&(n.viewContext=n.context.getCmp(t))},roundFlex:function(n){return Math.floor(n)},calculate:function(n){this.callParent(arguments);n.state.parallelDone&&(!this.owner.forceFit||n.flexedItems.length)&&n.setProp("columnWidthsDone",!0);n.viewContext&&(n.state.tableHeight=n.viewTable.offsetHeight)},completeLayout:function(n){var t=this,i=t.owner,r=n.state;t.callParent(arguments);!n.flexedItems.length&&!r.flexesCalculated&&i.forceFit&&t.convertWidthsToFlexes(n)?(t.cacheFlexes(n),n.invalidate({state:{flexesCalculated:!0}})):n.setProp("columnWidthsDone",!0)},convertWidthsToFlexes:function(n){var o=this,f=0,s=o.sizeModels.calculated,u,e,t,i,r;for(u=n.childItems,e=u.length,t=0;t<e;t++)i=u[t],r=i.target,f+=i.props.width,r.fixed||r.resizable===!1||(r.flex=n.childItems[t].flex=i.props.width,r.width=null,i.widthModel=s);return f!==n.props.width},getContainerSize:function(n){var i=this,r,t=n.viewContext,u;return i.owner.isColumn?r=i.getColumnContainerSize(n):(r=i.callParent(arguments),t&&!t.heightModel.shrinkWrap&&t.target.componentLayout.ownerContext&&(u=t.getProp("height"),isNaN(u)?i.done=!1:n.state.tableHeight>u&&(r.width-=Ext.getScrollbarSize().width,n.state.parallelDone=!1,t.invalidate()))),r},getColumnContainerSize:function(n){var o=n.paddingContext.getPaddingInfo(),r=0,u=0,f,e,t,i;return n.widthModel.shrinkWrap||(++u,t=n.getProp("innerWidth"),f=typeof t=="number",f&&(++r,t-=o.width,t<0&&(t=0))),n.heightModel.shrinkWrap||(++u,i=n.getProp("innerHeight"),e=typeof i=="number",e&&(++r,i-=o.height,i<0&&(i=0))),{width:t,height:i,needed:u,got:r,gotAll:r==u,gotWidth:f,gotHeight:e}},publishInnerCtSize:function(n){var t=this,i=n.state.boxPlan.targetSize,r=n.peek("contentWidth"),u;return t.owner.tooNarrow=n.state.boxPlan.tooNarrow,r==null||t.owner.isColumn||(i.width=r,u=t.owner.ownerCt.view,u.scrollFlags.y&&(i.width+=Ext.getScrollbarSize().width)),t.callParent(arguments)}})