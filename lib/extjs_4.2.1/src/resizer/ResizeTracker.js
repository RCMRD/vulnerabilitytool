Ext.define("Ext.resizer.ResizeTracker",{extend:"Ext.dd.DragTracker",dynamic:!0,preserveRatio:!1,constrainTo:null,proxyCls:Ext.baseCSSPrefix+"resizable-proxy",constructor:function(n){var t=this,i,r,u;n.el||(t.el=n.target.isComponent?n.target.getEl():n.target);this.callParent(arguments);t.preserveRatio&&t.minWidth&&t.minHeight&&(i=t.minWidth/t.el.getWidth(),r=t.minHeight/t.el.getHeight(),r>i?t.minWidth=t.el.getWidth()*r:t.minHeight=t.el.getHeight()*i);t.throttle&&(u=Ext.Function.createThrottled(function(){Ext.resizer.ResizeTracker.prototype.resize.apply(t,arguments)},t.throttle),t.resize=function(n,i,r){r?Ext.resizer.ResizeTracker.prototype.resize.apply(t,arguments):u.apply(null,arguments)})},onBeforeStart:function(){this.startBox=this.target.getBox()},getDynamicTarget:function(){var n=this,t=n.target;return n.dynamic?t:(n.proxy||(n.proxy=n.createProxy(t)),n.proxy.show(),n.proxy)},createProxy:function(n){var t,i=this.proxyCls;return t=n.isComponent?n.getProxy().addCls(i):n.createProxy({tag:"div",cls:i,id:n.id+"-rzproxy"},Ext.getBody()),t.removeCls(Ext.baseCSSPrefix+"proxy-el"),t},onStart:function(){this.activeResizeHandle=Ext.get(this.getDragTarget().id);this.dynamic||this.resize(this.startBox,{horizontal:"none",vertical:"none"})},onDrag:function(n){(this.dynamic||this.proxy)&&this.updateDimensions(n)},updateDimensions:function(n,t){var u=this,h=u.activeResizeHandle.region,f=u.getOffset(u.constrainTo?"dragTarget":null),r=u.startBox,p,e=0,o=0,c,l,v=0,y=0,k,d=f[0]<0?"right":"left",g=f[1]<0?"down":"up",a,s,i,w,b;h=u.convertRegionName(h);switch(h){case"south":o=f[1];s=2;break;case"north":o=-f[1];y=-o;s=2;break;case"east":e=f[0];s=1;break;case"west":e=-f[0];v=-e;s=1;break;case"northeast":o=-f[1];y=-o;e=f[0];a=[r.x,r.y+r.height];s=3;break;case"southeast":o=f[1];e=f[0];a=[r.x,r.y];s=3;break;case"southwest":e=-f[0];v=-e;o=f[1];a=[r.x+r.width,r.y];s=3;break;case"northwest":o=-f[1];y=-o;e=-f[0];v=-e;a=[r.x+r.width,r.y+r.height];s=3}if(i={width:r.width+e,height:r.height+o,x:r.x+v,y:r.y+y},c=Ext.Number.snap(i.width,u.widthIncrement),l=Ext.Number.snap(i.height,u.heightIncrement),c!=i.width||l!=i.height){switch(h){case"northeast":i.y-=l-i.height;break;case"north":i.y-=l-i.height;break;case"southwest":i.x-=c-i.width;break;case"west":i.x-=c-i.width;break;case"northwest":i.x-=c-i.width;i.y-=l-i.height}i.width=c;i.height=l}i.width<u.minWidth||i.width>u.maxWidth?(i.width=Ext.Number.constrain(i.width,u.minWidth,u.maxWidth),v&&(i.x=r.x+(r.width-i.width))):u.lastX=i.x;i.height<u.minHeight||i.height>u.maxHeight?(i.height=Ext.Number.constrain(i.height,u.minHeight,u.maxHeight),y&&(i.y=r.y+(r.height-i.height))):u.lastY=i.y;(u.preserveRatio||n.shiftKey)&&(p=u.startBox.width/u.startBox.height,w=Math.min(Math.max(u.minHeight,i.width/p),u.maxHeight),b=Math.min(Math.max(u.minWidth,i.height*p),u.maxWidth),s==1?i.height=w:s==2?i.width=b:(k=Math.abs(a[0]-this.lastXY[0])/Math.abs(a[1]-this.lastXY[1]),k>p?i.height=w:i.width=b,h=="northeast"?i.y=r.y-(i.height-r.height):h=="northwest"?(i.y=r.y-(i.height-r.height),i.x=r.x-(i.width-r.width)):h=="southwest"&&(i.x=r.x-(i.width-r.width))));o===0&&(g="none");e===0&&(d="none");u.resize(i,{horizontal:d,vertical:g},t)},getResizeTarget:function(n){return n?this.target:this.getDynamicTarget()},resize:function(n,t,i){var r=this,u=r.getResizeTarget(i);u.setBox(n);r.originalTarget&&(r.dynamic||i)&&r.originalTarget.setBox(n)},onEnd:function(n){this.updateDimensions(n,!0);this.proxy&&this.proxy.hide()},convertRegionName:function(n){return n}})