Ext.define("Ext.menu.Menu",{extend:"Ext.panel.Panel",alias:"widget.menu",requires:["Ext.layout.container.Fit","Ext.layout.container.VBox","Ext.menu.CheckItem","Ext.menu.Item","Ext.menu.KeyNav","Ext.menu.Manager","Ext.menu.Separator"],enableKeyNav:!0,allowOtherMenus:!1,ariaRole:"menu",floating:!0,constrain:!0,hidden:!0,hideMode:"visibility",ignoreParentClicks:!1,isMenu:!0,showSeparator:!0,minWidth:undefined,defaultMinWidth:120,initComponent:function(){var n=this,t=Ext.baseCSSPrefix,i=[t+"menu"],r=n.bodyCls?[n.bodyCls]:[],u=n.floating!==!1;n.addEvents("click","mouseenter","mouseleave","mouseover");Ext.menu.Manager.register(n);n.plain&&i.push(t+"menu-plain");n.cls=i.join(" ");r.push(t+"menu-body",Ext.dom.Element.unselectableCls);n.bodyCls=r.join(" ");n.layout||(n.layout={type:"vbox",align:"stretchmax",overflowHandler:"Scroller"});u?n.minWidth===undefined&&(n.minWidth=n.defaultMinWidth):(n.hidden=!!n.initialConfig.hidden,n.constrain=!1);n.callParent(arguments)},registerWithOwnerCt:function(){this.floating&&(this.ownerCt=null,Ext.WindowManager.register(this))},initHierarchyEvents:Ext.emptyFn,isVisible:function(){return this.callParent()},getHierarchyState:function(){var n=this.callParent();return n.hidden=this.hidden,n},beforeRender:function(){this.callParent(arguments);this.getSizeModel().width.shrinkWrap||(this.layout.align="stretch")},onBoxReady:function(){var n=this;n.callParent(arguments);n.showSeparator&&(n.iconSepEl=n.layout.getElementTarget().insertFirst({cls:Ext.baseCSSPrefix+"menu-icon-separator",html:"&#160;"}));n.mon(n.el,{click:n.onClick,mouseover:n.onMouseOver,scope:n});n.mouseMonitor=n.el.monitorMouseLeave(100,n.onMouseLeave,n);n.enableKeyNav&&(n.keyNav=new Ext.menu.KeyNav({target:n,keyMap:n.getKeyMap()}))},getRefOwner:function(){return this.parentMenu||this.ownerButton||this.callParent(arguments)},canActivateItem:function(n){return n&&!n.isDisabled()&&n.isVisible()&&(n.canActivate||n.getXTypes().indexOf("menuitem")<0)},deactivateActiveItem:function(n){var t=this,i=t.activeItem,r=t.focusedItem;i&&(i.deactivate(),i.activated||delete t.activeItem);r&&n&&(r.blur(),delete t.focusedItem)},getFocusEl:function(){return this.focusedItem||this.el},hide:function(){this.deactivateActiveItem(!0);this.callParent(arguments)},getItemFromEvent:function(n){return this.getChildByElement(n.getTarget())},lookupComponent:function(n){var t=this;return typeof n=="string"?n=t.lookupItemFromString(n):Ext.isObject(n)&&(n=t.lookupItemFromObject(n)),n.minWidth=n.minWidth||t.minWidth,n},lookupItemFromObject:function(n){var i=this,r=Ext.baseCSSPrefix,t;return n.isComponent||(n=n.xtype?Ext.ComponentManager.create(n,n.xtype):Ext.create("Ext.menu."+(Ext.isBoolean(n.checked)?"Check":"")+"Item",n)),n.isMenuItem&&(n.parentMenu=i),n.isMenuItem||n.dock||(t=[r+"menu-item-cmp"],i.plain||n.indent===!1&&n.iconCls!=="no-icon"||t.push(r+"menu-item-indent"),n.rendered?n.el.addCls(t):n.cls=(n.cls||"")+" "+t.join(" ")),n},lookupItemFromString:function(n){return n=="separator"||n=="-"?new Ext.menu.Separator:new Ext.menu.Item({canActivate:!1,hideOnClick:!1,plain:!0,text:n})},onClick:function(n){var i=this,t;if(i.disabled){n.stopEvent();return}if(t=n.type==="click"?i.getItemFromEvent(n):i.activeItem,t&&t.isMenuItem)if(t.menu&&i.ignoreParentClicks)n.stopEvent();else t.onClick(n);(!t||t.disabled)&&(t=undefined);i.fireEvent("click",i,t,n)},onDestroy:function(){var n=this;Ext.menu.Manager.unregister(n);n.parentMenu=n.ownerButton=null;n.rendered&&(n.el.un(n.mouseMonitor),Ext.destroy(n.keyNav),n.keyNav=null);n.callParent(arguments)},onMouseLeave:function(n){var t=this;(t.deactivateActiveItem(),t.disabled)||t.fireEvent("mouseleave",t,n)},onMouseOver:function(n){var t=this,e=n.getRelatedTarget(),u=!t.el.contains(e),i=t.getItemFromEvent(n),r=t.parentMenu,f=t.parentItem;(u&&r&&(r.setActiveItem(f),f.cancelDeferHide(),r.mouseMonitor.mouseenter()),t.disabled)||(i&&!i.activated&&(t.setActiveItem(i),i.activated&&i.expandMenu&&i.expandMenu()),u&&t.fireEvent("mouseenter",t,n),t.fireEvent("mouseover",t,i,n))},setActiveItem:function(n){var t=this;n&&n!=t.activeItem&&(t.deactivateActiveItem(),t.canActivateItem(n)&&(n.activate?(n.activate(),n.activated&&(t.activeItem=n,t.focusedItem=n,t.focus())):(n.focus(),t.focusedItem=n)),n.el.scrollIntoView(t.layout.getRenderTarget()))},showBy:function(){var n=this;return n.callParent(arguments),n.hidden||n.setVerticalPosition(),n},beforeShow:function(){var n=this,t;n.floating&&(n.savedMaxHeight=n.maxHeight,t=n.container.getViewSize().height,n.maxHeight=Math.min(n.maxHeight||t,t));n.callParent(arguments)},afterShow:function(){var n=this;n.callParent(arguments);n.floating&&(n.maxHeight=n.savedMaxHeight)},setVerticalPosition:function(){var n=this,u,t=n.getY(),r=t,i=n.getHeight(),e=Ext.Element.getViewportHeight().height,f=n.el.parent(),o=f.getViewSize().height,s=t-f.getScroll().top;f=null;n.floating&&(u=n.maxHeight?n.maxHeight:o-s,i>o?r=t-s:u<i?r=t-(i-u):t+i>e&&(r=e-i));n.setY(r)}})