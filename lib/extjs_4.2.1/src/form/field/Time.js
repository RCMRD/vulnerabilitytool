Ext.define("Ext.form.field.Time",{extend:"Ext.form.field.ComboBox",alias:"widget.timefield",requires:["Ext.form.field.Date","Ext.picker.Time","Ext.view.BoundListKeyNav","Ext.Date"],alternateClassName:["Ext.form.TimeField","Ext.form.Time"],triggerCls:Ext.baseCSSPrefix+"form-time-trigger",minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,pickerMaxHeight:300,selectOnTab:!0,snapToIncrement:!1,initDate:"1/1/2008",initDateFormat:"j/n/Y",ignoreSelection:0,queryMode:"local",displayField:"disp",valueField:"date",initComponent:function(){var n=this,t=n.minValue,i=n.maxValue;t&&n.setMinValue(t);i&&n.setMaxValue(i);n.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : this.formatDate(values["'+n.displayField+'"])]}<tpl if="xindex < xcount">'+n.delimiter+"<\/tpl><\/tpl>",{formatDate:Ext.Function.bind(n.formatDate,n)});this.callParent()},transformOriginalValue:function(n){return Ext.isString(n)?this.rawToValue(n):n},isEqual:function(n,t){return Ext.Date.isEqual(n,t)},setMinValue:function(n){var t=this,i=t.picker;t.setLimit(n,!0);i&&i.setMinValue(t.minValue)},setMaxValue:function(n){var t=this,i=t.picker;t.setLimit(n,!1);i&&i.setMaxValue(t.maxValue)},setLimit:function(n,t){var u=this,i,r;Ext.isString(n)?i=u.parseDate(n):Ext.isDate(n)&&(i=n);i?(r=Ext.Date.clearTime(new Date(u.initDate)),r.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):r=null;u[t?"minValue":"maxValue"]=r},rawToValue:function(n){return this.parseDate(n)||n||null},valueToRaw:function(n){return this.formatDate(this.parseDate(n))},getErrors:function(n){var t=this,u=Ext.String.format,i=t.callParent(arguments),f=t.minValue,e=t.maxValue,r;return(n=t.formatDate(n||t.processRawValue(t.getRawValue())),n===null||n.length<1)?i:(r=t.parseDate(n),!r)?(i.push(u(t.invalidText,n,Ext.Date.unescapeFormat(t.format))),i):(f&&r<f&&i.push(u(t.minText,t.formatDate(f))),e&&r>e&&i.push(u(t.maxText,t.formatDate(e))),i)},formatDate:function(){return Ext.form.field.Date.prototype.formatDate.apply(this,arguments)},parseDate:function(n){var i=this,t=n,f=i.altFormats,r=i.altFormatsArray,u=0,e;if(n&&!Ext.isDate(n)&&(t=i.safeParse(n,i.format),!t&&f))for(r=r||f.split("|"),e=r.length;u<e&&!t;++u)t=i.safeParse(n,r[u]);return t&&i.snapToIncrement&&(t=new Date(Ext.Number.snap(t.getTime(),i.increment*6e4))),t},safeParse:function(n,t){var f=this,i=Ext.Date,r,u=null;return i.formatContainsDateInfo(t)?u=i.parse(n,t):(r=i.parse(f.initDate+" "+n,f.initDateFormat+" "+t),r&&(u=r)),u},getSubmitValue:function(){var n=this,i=n.submitFormat||n.format,t=n.getValue();return t?Ext.Date.format(t,i):null},createPicker:function(){var n=this,t;return n.listConfig=Ext.apply({xtype:"timepicker",selModel:{mode:"SINGLE"},cls:undefined,minValue:n.minValue,maxValue:n.maxValue,increment:n.increment,format:n.format,maxHeight:n.pickerMaxHeight},n.listConfig),t=n.callParent(),n.bindStore(t.store),t},onItemClick:function(n,t){var r=this,i=n.getSelectionModel().getSelection();i.length>0&&(i=i[0],i&&Ext.Date.isEqual(t.get("date"),i.get("date"))&&r.collapse())},onListSelectionChange:function(n,t){if(t.length){var i=this,r=t[0].get("date");i.ignoreSelection||(i.skipSync=!0,i.setValue(r),i.skipSync=!1,i.fireEvent("select",i,r),i.picker.clearHighlight(),i.collapse(),i.inputEl.focus())}},syncSelection:function(){var n=this,t=n.picker,o,u,i,f,r,s,e;if(t&&!n.skipSync){if(t.clearHighlight(),i=n.getValue(),u=t.getSelectionModel(),n.ignoreSelection++,i===null)u.deselectAll();else if(Ext.isDate(i)){for(f=t.store.data.items,s=f.length,r=0;r<s;r++)if(e=f[r],Ext.Date.isEqual(e.get("date"),i)){o=e;break}u.select(o)}n.ignoreSelection--}},postBlur:function(){var n=this,t=n.getValue();n.callParent(arguments);n.wasValid&&t&&n.setRawValue(n.formatDate(t))},setValue:function(){return this.getPicker(),this.callParent(arguments)},getValue:function(){return this.parseDate(this.callParent(arguments))}})