Ext.define("Ext.form.field.Date",{extend:"Ext.form.field.Picker",alias:"widget.datefield",requires:["Ext.picker.Date"],alternateClassName:["Ext.form.DateField","Ext.form.Date"],format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerCls:Ext.baseCSSPrefix+"form-date-trigger",showToday:!0,useStrict:undefined,initTime:"12",initTimeFormat:"H",matchFieldWidth:!1,startDay:0,initComponent:function(){var n=this,r=Ext.isString,t,i;t=n.minValue;i=n.maxValue;r(t)&&(n.minValue=n.parseDate(t));r(i)&&(n.maxValue=n.parseDate(i));n.disabledDatesRE=null;n.initDisabledDays();n.callParent()},initValue:function(){var n=this,t=n.value;Ext.isString(t)&&(n.value=n.rawToValue(t));n.callParent()},initDisabledDays:function(){if(this.disabledDates){for(var i=this.disabledDates,u=i.length-1,r="(?:",f=i.length,t,n=0;n<f;n++)t=i[n],r+=Ext.isDate(t)?"^"+Ext.String.escapeRegex(t.dateFormat(this.format))+"$":t,n!==u&&(r+="|");this.disabledDatesRE=new RegExp(r+")")}},setDisabledDates:function(n){var t=this,i=t.picker;t.disabledDates=n;t.initDisabledDays();i&&i.setDisabledDates(t.disabledDatesRE)},setDisabledDays:function(n){var t=this.picker;this.disabledDays=n;t&&t.setDisabledDays(n)},setMinValue:function(n){var t=this,i=t.picker,r=Ext.isString(n)?t.parseDate(n):n;t.minValue=r;i&&(i.minText=Ext.String.format(t.minText,t.formatDate(t.minValue)),i.setMinDate(r))},setMaxValue:function(n){var t=this,i=t.picker,r=Ext.isString(n)?t.parseDate(n):n;t.maxValue=r;i&&(i.maxText=Ext.String.format(t.maxText,t.formatDate(t.maxValue)),i.setMaxDate(r))},getErrors:function(n){var t=this,r=Ext.String.format,c=Ext.Date.clearTime,i=t.callParent(arguments),u=t.disabledDays,l=t.disabledDatesRE,f=t.minValue,e=t.maxValue,y=u?u.length:0,o=0,a,s,v,h;if(n=t.formatDate(n||t.processRawValue(t.getRawValue())),n===null||n.length<1)return i;if(a=n,n=t.parseDate(n),!n)return i.push(r(t.invalidText,a,Ext.Date.unescapeFormat(t.format))),i;if(h=n.getTime(),f&&h<c(f).getTime()&&i.push(r(t.minText,t.formatDate(f))),e&&h>c(e).getTime()&&i.push(r(t.maxText,t.formatDate(e))),u)for(v=n.getDay();o<y;o++)if(v===u[o]){i.push(t.disabledDaysText);break}return s=t.formatDate(n),l&&l.test(s)&&i.push(r(t.disabledDatesText,s)),i},rawToValue:function(n){return this.parseDate(n)||n||null},valueToRaw:function(n){return this.formatDate(this.parseDate(n))},safeParse:function(n,t){var r=this,i=Ext.Date,u=null,e=r.useStrict,f;return i.formatContainsHourInfo(t)?u=i.parse(n,t,e):(f=i.parse(n+" "+r.initTime,t+" "+r.initTimeFormat,e),f&&(u=i.clearTime(f))),u},getSubmitValue:function(){var t=this.submitFormat||this.format,n=this.getValue();return n?Ext.Date.format(n,t):""},parseDate:function(n){if(!n||Ext.isDate(n))return n;var t=this,i=t.safeParse(n,t.format),f=t.altFormats,r=t.altFormatsArray,u=0,e;if(!i&&f)for(r=r||f.split("|"),e=r.length;u<e&&!i;++u)i=t.safeParse(n,r[u]);return i},formatDate:function(n){return Ext.isDate(n)?Ext.Date.dateFormat(n,this.format):n},createPicker:function(){var n=this,t=Ext.String.format;return new Ext.picker.Date({pickerField:n,ownerCt:n.ownerCt,renderTo:document.body,floating:!0,hidden:!0,focusOnShow:!0,minDate:n.minValue,maxDate:n.maxValue,disabledDatesRE:n.disabledDatesRE,disabledDatesText:n.disabledDatesText,disabledDays:n.disabledDays,disabledDaysText:n.disabledDaysText,format:n.format,showToday:n.showToday,startDay:n.startDay,minText:t(n.minText,n.formatDate(n.minValue)),maxText:t(n.maxText,n.formatDate(n.maxValue)),listeners:{scope:n,select:n.onSelect},keyNavConfig:{esc:function(){n.collapse()}}})},onDownArrow:function(){this.callParent(arguments);this.isExpanded&&this.getPicker().focus()},onSelect:function(n,t){var i=this;i.setValue(t);i.fireEvent("select",i,t);i.collapse()},onExpand:function(){var n=this.getValue();this.picker.setValue(Ext.isDate(n)?n:new Date)},onCollapse:function(){this.focus(!1,60)},beforeBlur:function(){var n=this,t=n.parseDate(n.getRawValue()),i=n.focusTask;i&&i.cancel();t&&n.setValue(t)}})