function submitOnEnter(field, event) {
    if (event.getKey() == event.ENTER) {
        field.up('form').getForm().submit();
    }
}
Ext.define('VulnerabilityToolLogin.view.user.Login', {
    extend: 'Ext.window.Window',
    alias : 'widget.userLogin',
    width: 300,
    title : 'User Login',
    layout: 'fit',
    autoShow: true,

    initComponent: function() {
        this.items = [
            {
                xtype: 'form',
                id: 'login_form_id',
                listeners: {
                    specialkey: submitOnEnter
                },
                items: [

                    {
                        xtype: 'textfield',
                        name : 'username',
                        fieldLabel: 'Username'
                    },
                    {
                        xtype: 'textfield',
                        name : 'password',
                        inputType: 'password',
                        fieldLabel: 'Password'
                    },
                    {
                        xtype: 'panel',
                        html:'<div class="panelCont">If you don\'t have an account yet ' +
                        'request the administrator at '+ config.administrator.email +
                        ' to create an account for you.</div>'
                    },
                    {
                        buttons: [{
                            text: 'Login',
                            enableKeyEvents: true,
                            handler: function () {
                                var form = this.up('form').getForm();
                                if (form.isValid()) {
                                    form.submit({
                                        url: 'data/login.php',
                                        waitMsg: 'Please wait...',
                                        success: function (f, a) {
                                            var result = a.result;
                                            data = result.data;
                                            group = data.group;
                                            console.log(group);
                                            if (group == "Admin") {
                                                window.location = "administer.php";
                                            }
                                            else if (group == "User") {
                                                window.location = "addPhoto.php";
                                            }
                                            else if (group == "Guest"){
                                                window.location = "index.php";
                                            }
                                        },
                                        failure: function (f, a) {
                                            Ext.Msg.alert('Failure',"Your user name and/ or Password is invalid." +
                                            " Contact the administrator at " + config.administrator.email);
                                        }
                                    });
                                }
                            }

                        }]
                    }
                ]
            }
        ];
        this.callParent(arguments);
    }
});